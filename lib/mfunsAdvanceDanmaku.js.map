{"version":3,"sources":["webpack://mf-ade/./node_modules/css-loader/dist/runtime/api.js","webpack://mf-ade/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://mf-ade/./src/css/base.css","webpack://mf-ade/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://mf-ade/webpack/bootstrap","webpack://mf-ade/webpack/runtime/compat get default export","webpack://mf-ade/webpack/runtime/define property getters","webpack://mf-ade/webpack/runtime/hasOwnProperty shorthand","webpack://mf-ade/./src/css/base.css?6b6c","webpack://mf-ade/./src/ts/Context/Context.ts","webpack://mf-ade/./src/ts/i18n/zh-cn.ts","webpack://mf-ade/./src/ts/i18n/index.ts","webpack://mf-ade/./src/ts/core/Renderer/BaseRenderer.ts","webpack://mf-ade/./src/ts/util/UnitTools.ts","webpack://mf-ade/./src/ts/core/Style/Unit/PxSize.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CssDanmakuObj.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CSS3Renderer.ts","webpack://mf-ade/./src/ts/Factory/RendererFactory.ts","webpack://mf-ade/./src/ts/TimeLine/AdvancedLine.ts","webpack://mf-ade/./src/ts/Factory/TimeLineFactort.ts","webpack://mf-ade/./src/ts/util/deepMerge.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Cubic.ts","webpack://mf-ade/./src/ts/core/Animation/Base/CubicAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Matrix.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/GroupAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/ListAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/styleAnimations/OpacityAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/StaticAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/RepeatAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/OriginAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/ScaleAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/TranslateAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationXAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationYAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationZAnimation.ts","webpack://mf-ade/./src/ts/Factory/AnimationFactory.ts","webpack://mf-ade/./src/ts/core/Danmaku/BaseDanmaku.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/DanmakuFactory.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/JsonDanmakuParser.ts","webpack://mf-ade/./src/ts/Controller/Controller.ts","webpack://mf-ade/./src/ts/core/Style/Unit/Color.ts","webpack://mf-ade/./src/ts/core/Stage/BaseStage.ts","webpack://mf-ade/./src/ts/core/Stage/TestStage.ts","webpack://mf-ade/./src/ts/index.ts"],"names":["module","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","n","prototype","call","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","___CSS_LOADER_EXPORT___","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","defineProperty","enumerable","get","prop","hasOwnProperty","language","debug","t","str","tranTxt","Context","reset","addDanmaku","_danmaku","refresh","setCanvasContainer","canvas","updateCanvasStyle","width","size","string","height","left","position","x","top","y","backgroundColor","color","lengthSrting","num","Matrix3dString","SyntaxError","i18n","recursionDanmaku","danmaku","danmakuobj","div","createDiv","getContent","setStyle","getStyle","childObj","element","animation","getAnimation","child","start","startTime","getChild","innerText","recursionDiv","array","ele","assign","recursionStyle","abstime","parentTime","dan","sty","max","time","getMatrix","transform","UnitTools","parentElement","canvasSize","PxSize","danmakuList","r","DanmakuTool","innerHTML","getRenderInstance","type","rendererList","ReferenceError","BaseRenderer","css3","CSS3Renderer","lastTime","end","getDuration","timeToIndex","Math","floor","getDanmakuList","skip","DanmakuList","timeIndex","l","getTimeLine","AdvancedLine","deepMerge","obj1","obj2","b","c","px3","px2","px1","py3","py2","py1","epsilon","getX","getY","solve","g","abs","cubic","duration","isEnd","p","getProgress","getMatrixForCubic","getCubicStyle","setParams","param","progress","getCubic","getProgressValue","cubicFunc","Cubic","add","sub","mult","a1","tran","b1","m","fill","j","k","getNullMatrix","animations","cumulativeMatrix","AnimationFactory","getAnimationsList","val","dur","Matrix","_progress","boxStyle","fontStyle","noneStyle","style2","matrix","CubicAnimations","cumulativeTime","curAnimation","getCurAnimation","mat","opacity","_time","z","repeat","getCurTime","getAnimations","params","StaticAnimation","console","log","animationTime","origin","getMatrixForOrigin","scale","x1","y1","z1","x2","y2","z2","OriginAnimations","path","angle","A2R","PI","sin","cos","RotationAnimation","animationList","ani","TranslateAnimation","RotationXAnimation","RotationYAnimation","RotationZAnimation","ScaleAnimations","ListAnimations","GroupAnimations","RepeatAnimations","OpacityAnimations","warn","getType","getDanmakuInstance","BaseDanmaku","parser","json","parse","getDanmaku","DanmakuFactory","childs","containers","stageList","pauseStatus","timeStamp","skipStatus","danmakuFunction","canvasStyle","getComputedStyle","initContainer","that","animloop","requestAnimationFrame","getContainersSize","parseInt","registStage","stage","mount","info","getDIV","render","RendererFactory","rendererType","stageRenderer","lineType","timeLineType","timeline","TimeLineFactory","timeLine","resetDanmaku","getCanvasStylByStage","classList","resize","getRenderer","stageSize","stageBackgroundColor","stagePosition","Date","now","pause","getTime","addGetDanmakuFunction","fun","res","JsonDanmakuParser","danmakuStr","getColor","containersSize","Color","renderer","timeLineObj","BaseStage","config","controller","Controller","TestStage","globalThis","MFADE"],"mappings":"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","file":"mfunsAdvanceDanmaku.js","sourcesContent":["\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-family: Arial, Helvetica, sans-serif;\\n    font-size: 100px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/base.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;IACtB,4BAA4B;IAC5B,SAAS;IACT,UAAU;IACV,yCAAyC;IACzC,gBAAgB;IAChB,0BAA0B,EAAE,gBAAgB;AAChD;AACA;IACI,kBAAkB;IAClB,gBAAgB;IAChB,kBAAkB;IAClB,4BAA4B;AAChC;AACA;IACI,sBAAsB;AAC1B\",\"sourcesContent\":[\".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-family: Arial, Helvetica, sans-serif;\\n    font-size: 100px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./base.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/**\n * 全局上下文\n */\nexport class Context{\n    /**\n     * 当前语言\n     */\n    public static language:string = \"zh-cn\";\n    public static debug = false;\n}\n\n","export default {\n    \"Containers is null\" : \"容器为空\",\n    \"Start mount stage\" : \"开始挂载舞台\",\n    \"Renderer type is null\": \"没有找到合适的渲染器\",\n    \"matrix3d param less than 16\":\"matrix3d 参数小于16个\",\n}","import { Context } from \"../Context/Context\";\nimport zhCn from \"./zh-cn\";\n/**\n * i18n 国际化函数\n */\nexport class i18n {\n    private static tranTxt = {\n        \"zh-cn\": zhCn\n    }\n    /**\n     * 当前语言\n     */\n    private static language: string = Context.language;\n    /**\n     * 获取翻译，如果不存在，则返回自身\n     * @param str 需要国际化的字符串\n     * @returns 翻译结果\n     */\n    public static t(str: string): string {\n        //检查字符串是否存在\n        if (this.tranTxt[this.language] && this.tranTxt[this.language][str]) {\n            return this.tranTxt[this.language][str];\n        }\n        return str;\n    }\n}","\n\nimport { DanmakuItemInterface } from \"../Danmaku/DanmakuItemInterface\";\nimport { canvasStyle } from \"../Style/CanvasStyle\";\nimport { RendererInterface } from \"./RendererInterface\";\n\nexport class BaseRenderer implements RendererInterface {\n    reset(): boolean {\n        throw new Error(\"Method not implemented.\");\n    }\n    addDanmaku(_danmaku: DanmakuItemInterface): boolean {\n        return false;\n    }\n    refresh(): boolean {\n        return false\n    }\n    protected canvas?: HTMLElement\n    setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true\n    }\n    updateCanvasStyle(style: canvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = style.size.width.string();\n            this.canvas.style.height = style.size.height.string();\n            this.canvas.style.left = style.position.x.string()\n            this.canvas.style.top = style.position.y.string()\n            this.canvas.style.backgroundColor = style.color.string()\n            return true\n        } else {\n            return false\n        }\n    }\n}","import { i18n } from \"../i18n\";\n\nexport class UnitTools{\n    /**\n     * 拼接带单位的长度字符串\n     * @param num 长度\n     * @returns \n     */\n    static lengthSrting(num:number):string{\n        return num + \"px\";\n    }\n    /**\n     * 拼接 Matrix3d() 字符串\n     * @param arr 16位数字\n     */\n    static Matrix3dString(arr:Array<number>):string{\n        if(arr.length != 16){\n            throw SyntaxError(i18n.t(\"matrix3d param less than 16\"));\n        }\n        return \"Matrix3d(\" + arr.join(\",\") + \")\";\n    }\n    // static UnitFactory(type:string,obj):string{\n\n    // }\n}","import { UnitInterface } from \"./UnitInterface\";\n\nexport class PxSize implements UnitInterface{\n    length:number\n    constructor(length:number){\n        this.length = length;\n    }\n    string(): string {\n        return this.length +\"px\";\n    }\n\n}","import { UnitTools } from \"src/ts/util/UnitTools\";\nimport { AnimationInterface } from \"../../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\n\nexport interface DanmakuObj {\n    element: HTMLElement,\n    style: DanmakuStyle\n    animation: AnimationInterface\n    child: DanmakuObj[]\n    start:number\n}\nexport class DanmakuTool {\n    /**\n   * 递归构建弹幕对象\n   * @param danmaku \n   * @returns \n   */\n    static recursionDanmaku(danmaku: DanmakuItemInterface[]): DanmakuObj[] {\n        let danmakuobj: DanmakuObj[] = []\n        danmaku.forEach((danmaku) => {\n            let div = this.createDiv(danmaku.getContent())\n            this.setStyle(div,danmaku.getStyle());\n            let obj: DanmakuObj = {\n                element: div,\n                animation: danmaku.getAnimation(),\n                style: danmaku.getStyle(),\n                child: [],\n                start:danmaku.startTime()\n            }\n            let child = danmaku.getChild()\n            let childObj;\n            if (child) {\n                childObj = this.recursionDanmaku(child)\n            }\n\n            obj.child = childObj;\n            danmakuobj.push(obj);\n        })\n        return danmakuobj\n    }\n    /**\n     * 创建一个空div\n     * @param content \n     * @returns \n     */\n    static createDiv(content: string): HTMLElement {\n        let div = document.createElement(\"div\");\n        div.style.position = \"absolute\"\n        div.innerText = content\n        return div\n    }\n    \n    /**\n     * 递归构建element\n     * @param danmakuobj \n     * @returns \n     */\n     static recursionDiv(danmakuobj:DanmakuObj[]):HTMLElement[]{\n        let array:Array<HTMLElement> = []\n        danmakuobj.forEach((item)=>{\n            let element = item.element;\n            if (item.child){\n                let eles = this.recursionDiv(item.child)\n                eles.forEach((ele)=>{\n                    element.appendChild(ele);\n                })\n            }\n            array.push(element);\n        })\n        return array\n    }\n    /**\n     * 将样式设置到元素中\n     */\n    static setStyle(element:HTMLElement,style:{ [idx: string]: any; }){\n        Object.assign(element.style,style)\n    }\n    /**\n     * 递归设置弹幕动画\n     * @param danmaku \n     */\n    static recursionStyle(danmaku:DanmakuObj[],canvas:HTMLElement,abstime:number,parentTime:number = 0){ \n        danmaku.forEach((dan,key)=>{\n            //更新弹幕样式\n            let time = parentTime == 0 ? abstime - dan.start: parentTime - dan.start;\n            \n            // console.log(dan.animation);\n            \n            let sty;\n            let max;\n            if(sty = dan.animation.getStyle(time)){\n            \n                this.setStyle(dan.element,sty)\n            }\n            if(max = dan.animation.getMatrix(time)){\n                dan.element.style.transform = UnitTools.Matrix3dString(max);\n            }\n            \n            //如果都不存在，则表示动画已经完成，销毁元素\n            //如果是子元素的情况，有可能存在弹幕未开始的情况\n            if(!(sty || max)){\n                \n                \n                if(dan.element.parentElement){\n                    //从父元素删除节点\n                    dan.element.parentElement.removeChild(dan.element)\n                }else{\n                    //否则从canvas里面删除\n                    canvas.removeChild(dan.element);\n                }\n                //并且清空节点\n                delete danmaku[key];\n            }\n            //递归\n            this.recursionStyle(dan.child,canvas,abstime,time);\n        })\n    }\n}","import { UnitTools } from \"src/ts/util/UnitTools\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { canvasStyle } from \"../../Style/CanvasStyle\";\nimport { SizeInterface } from \"../../Style/SizeInterface\";\nimport { PxSize } from \"../../Style/Unit/PxSize\";\nimport { RendererInterface } from \"../RendererInterface\";\nimport { DanmakuObj, DanmakuTool } from \"./CssDanmakuObj\";\n\n\nexport class CSS3Renderer implements RendererInterface {\n\n    canvasSize: SizeInterface = {\n        width: new PxSize(1920),\n        height: new PxSize(1080)\n    }\n    canvas?: HTMLElement\n    danmakuList: DanmakuObj[] = []\n    setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true;\n    }\n    updateCanvasStyle(style: canvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = this.canvasSize.width.string();\n            this.canvas.style.height =this.canvasSize.height.string();\n            this.canvas.style.left = UnitTools.lengthSrting((style.size.width.length - this.canvasSize.width.length) / 2)\n            this.canvas.style.top = UnitTools.lengthSrting((style.size.height.length - this.canvasSize.height.length) / 2)\n            this.canvas.style.backgroundColor = style.color.string()\n            let r: number;//缩放大小\n            if (style.size.width.length / style.size.height.length >= this.canvasSize.width.length / this.canvasSize.height.length) {\n                //横向\n                r = style.size.height.length / this.canvasSize.height.length\n            } else {\n                //纵向\n                r = style.size.width.length / this.canvasSize.width.length\n            }\n            this.canvas.style.transform = \"scale(\" + r + \",\" + r + \")\"\n            return true\n        } else {\n            return false\n        }\n    }\n    addDanmaku(danmaku: DanmakuItemInterface): boolean {\n        if(!this.canvas) return false\n        let danmakuobj = DanmakuTool.recursionDanmaku([danmaku]) \n        let eles = DanmakuTool.recursionDiv(danmakuobj)\n        eles.forEach((ele) => {\n            this.canvas?.appendChild(ele)\n        })\n        this.danmakuList.push(...danmakuobj);\n        // console.log(this.danmakuList);\n        \n        return true;\n    }\n\n\n\n    refresh(time): boolean {\n        if (!this.canvas) {\n            return false;\n        }\n        \n        DanmakuTool.recursionStyle(this.danmakuList,this.canvas,time)\n        return true;\n    }\n    reset(): boolean {\n        //清空画布\n        \n        if(this.canvas){\n            this.canvas.innerHTML = \"\";\n        }\n        //清空数组\n        this.danmakuList = []\n        return true\n        \n    }\n}\n","/**\n * 简单渲染器工厂\n */\n\nimport { i18n } from \"src/ts/i18n\";\nimport { BaseRenderer } from \"src/ts/core/Renderer/BaseRenderer\";\nimport { RendererInterface } from \"src/ts/core/Renderer/RendererInterface\";\nimport { CSS3Renderer } from \"../core/Renderer/CSS3Renderer/CSS3Renderer\";\n\nexport class RendererFactory{\n    static rendererList = {\n        base:BaseRenderer,\n        css3:CSS3Renderer\n    }\n    static getRenderInstance(type:string):RendererInterface{\n        if (this.rendererList[type]) {\n            return new this.rendererList[type]()\n        }else{\n            throw ReferenceError(i18n.t(\"Renderer type is null\"))\n        }\n    }\n}","import { DanmakuItemInterface } from \"../core/Danmaku/DanmakuItemInterface\";\nimport { TimeLineDanmaku } from \"./TimeLineDanmaku\";\nimport { TimeLineInterface } from \"./TimeLineInterface\";\n\nexport class AdvancedLine implements TimeLineInterface {\n  \n\n    /**\n     * 上次获取时间(10ms)\n     */\n    lastTime: number = 0\n    /**\n     * 时间轴,二维数组，一维是弹幕的开始10毫秒数，二维是此毫秒数下的弹幕集合\n     * 注意：为了节省性能，最小单位时间是10ms，\n     *       仅仅是数组下标是10ms，其余的都是按照ms计算的\n     */\n    danmakuList: TimeLineDanmaku[][] = [];\n\n    /**\n     * 添加一个弹幕\n     * @param danmaku \n     * @param start\n     * @param end\n     */\n    addDanmaku(danmaku: DanmakuItemInterface, start?: number, end?: number) {\n\n        start = start || danmaku.startTime()\n\n        end = end || danmaku.getAnimation().getDuration() + start\n        let index = this.timeToIndex(start);\n\n        if(!this.danmakuList[index]){\n            this.danmakuList[index] = []\n        }\n        this.danmakuList[index].push({\n            danmaku: danmaku,\n            start: start,\n            end:end\n        })\n    }\n    /**\n     * 时间转换\n     * @param time \n     * @returns \n     */\n    protected timeToIndex(time: number): number {\n        return Math.floor(time / 10)\n    }\n    getDanmakuList(time: number):{skip:boolean;DanmakuList:TimeLineDanmaku[]}  {\n        time = this.timeToIndex(time);\n        //如果请求的时间超过了时间轴。。。\n        if (time < 0) {\n            return {skip:false,DanmakuList:[]};\n        }\n\n        let arr: TimeLineDanmaku[] = [];\n        let skip = false;\n        if (this.lastTime <= time && time - this.lastTime < 5) {\n            //正常播放情况,遍历期间的所有内容\n            // console.log(this.lastTime);\n            \n            for (let a = this.lastTime; a < time; a++) {\n                \n                if (this.danmakuList[a]) {\n                    // console.log(time);\n                    \n                    arr.push(...this.danmakuList[a])\n                }\n            }\n\n        } else {\n            //否则说明播放发生了跳转，则遍历找到合适的内容\n            //查找范围：在当前时间之前开始的，并且结束于当前时间之后的，\n            //先找到之前开始的\n            // console.log(time);\n            for (let timeIndex = 0; timeIndex < time; timeIndex++) {\n                if (!this.danmakuList[timeIndex]) {\n                    continue;//当前时间不存在\n                }\n                //接着再查找当前时间之后结束的\n                for (let l = 0; l < this.danmakuList.length; l++) {\n                    if (this.danmakuList[timeIndex][l]\n                        &&\n                        this.timeToIndex(this.danmakuList[timeIndex][l].end)\n                        > time) {\n                        arr.push(this.danmakuList[timeIndex][l])\n                    }\n                }\n            }\n            skip = true;\n\n        }\n        this.lastTime = time\n        return {skip:skip,DanmakuList:arr};\n    }\n    reset(): boolean {\n        this.danmakuList = []\n        return true\n    }\n}\n\n","import { AdvancedLine } from \"../TimeLine/AdvancedLine\";\nimport { TimeLineInterface } from \"../TimeLine/TimeLineInterface\";\n\nexport class TimeLineFactory{\n    static list = {\n        \"defult\":AdvancedLine,\n        \"advance\":AdvancedLine\n    }\n    static getTimeLine(type:string):TimeLineInterface{\n        if(!this.list[type]){\n           type = \"default\"\n        }\n        return new this.list[type]()\n    }\n}","/**\n * 对象深度合并\n * @param obj1 \n * @param obj2 \n * @returns \n */\nexport function deepMerge(obj1, obj2) {\n    let key;\n    for (key in obj2) {\n      // 如果target(也就是obj1[key])存在，且是对象的话再去调用deepMerge，否则就是obj1[key]里面没这个对象，需要与obj2[key]合并\n      // 如果obj2[key]没有值或者值不是对象，此时直接替换obj1[key]\n      obj1[key] =\n        obj1[key] &&\n        obj1[key].toString() === \"[object Object]\" &&\n        (obj2[key] && obj2[key].toString() === \"[object Object]\")\n          ? deepMerge(obj1[key], obj2[key])\n          : (obj1[key] = obj2[key]);\n    }\n    return obj1;\n  }","/**\n * 贝塞尔相关工具函数\n */\nexport class Cubic {\n    px3: number\n    px2: number\n    px1: number\n    py3: number\n    py2: number\n    py1: number\n    epsilon: number\n    constructor (a: number, b: number, c: number, d: number) {\n      this.px3 = 3 * a\n      this.px2 = 3 * (c - a) - this.px3\n      this.px1 = 1 - this.px3 - this.px2\n      this.py3 = 3 * b\n      this.py2 = 3 * (d - b) - this.py3\n      this.py1 = 1 - this.py3 - this.py2\n      this.epsilon = 1e-7      // 目标精度\n    }\n  \n    getX(t: number) {\n      return ((this.px1 * t + this.px2) * t + this.px3) * t\n    }\n  \n    getY(t: number) {\n      return ((this.py1 * t + this.py2) * t + this.py3) * t    \n    }\n  \n    solve(x: number) {\n      if (x === 0 || x === 1) {             // 对 0 和 1 两个特殊 t 不做计算\n        return this.getY(x)\n      } \n      let t = x\n      for (let i = 0; i < 8; i++) {         // 进行 8 次迭代\n        let g = this.getX(t) - x\n        if (Math.abs(g) < this.epsilon) {   // 检测误差到可以接受的范围\n          return this.getY(t)\n        }\n        let d = (3 * this.px1 * t + 2 * this.px2) * t + this.px3   // 对 x 求导\n        if (Math.abs(d) < 1e-6) {           // 如果梯度过低，说明牛顿迭代法无法达到更高精度\n          break\n        }\n        t = t - g / d\n      }\n      return this.getY(t)                   // 对得到的近似 t 求 y\n    }\n  }\n  ","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"./AnimationInterface\";\nimport { Cubic } from \"./Cubic\";\n\n/**\n * 贝塞尔动画类\n */\nexport abstract class CubicAnimations implements AnimationInterface {\n\n    /**\n     * 贝塞尔函数\n     */\n    cubicFunc: Cubic;\n    /**\n     * 贝塞尔参数\n     */\n    cubic: [number, number, number, number] = [0, 0, 1, 1]\n    /**\n     * 动画总时间\n     */\n    duration: number = 1000\n    //currentTime:number = 0\n    getMatrix(time: number): false | number[] {\n        if (this.isEnd(time)) return false\n        let p = this.getProgress(time)\n        let a = this.getMatrixForCubic(p, this.duration * p)\n        return a\n    }\n    getStyle(time: number): false | DanmakuStyle {\n        if (this.isEnd(time)) return false\n        let p = this.getProgress(time)\n        return this.getCubicStyle(p, this.duration * p)\n    }\n    setParams(param?: { [idx: string]: any; }): boolean {  \n        this.cubic = param?.cubic ? param?.cubic : this.cubic\n        this.duration = param?.duration ? param?.duration : this.duration\n        return true\n    }\n    getDuration(): number {\n        \n        return this.duration;\n    }\n    /**\n     * 根据动画时间获取动画进度\n     * @param time 动画时间\n     * @returns \n     */\n    getProgress(time: number): number {\n        //计算当前动画进度\n        let progress: number = time / this.duration\n        //计算出实际动画进度\n        let a = this.getCubic().solve(progress)\n        return a;\n    }\n    /**\n     * 根据进度返回区间内的值\n     * @param start \n     * @param end \n     * @param progress \n     */\n    getProgressValue(start: number, end: number, progress: number): number {\n        return start + (end - start) * progress\n    }\n    /**\n     * 判断动画是否结束\n     */\n    protected isEnd(time: number) {\n        return time > this.duration\n    }\n    /**\n     * 获取贝塞尔函数\n     * @returns \n     */\n    getCubic(): Cubic {\n        if (!this.cubicFunc) {\n            this.cubicFunc = new Cubic(...this.cubic)\n        }\n        return this.cubicFunc;\n    }\n    /**\n     * 计算贝塞尔样式\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     */\n    abstract getCubicStyle(progress: number, time: number): DanmakuStyle | false\n    /**\n     * 计算贝塞尔的矩阵\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     * @\n     */\n    abstract getMatrixForCubic(progress: number, time: number): number[] | false\n\n}","/**\n * 矩阵变换相关工具函数\n */\nexport class Matrix {\n    /**\n     * 加法\n     * @param a \n     * @param b \n     */\n    static add(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] + b[i]\n        }\n        return c\n    }\n    /**\n     * 减法\n     * @param a \n     * @param b \n     * @returns \n     */\n    static sub(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] - b[i]\n        }\n        return c\n    }\n    static mult(a: number[], b: number[]): number[] {\n        let a1 = this.tran(a);\n        let b1 = this.tran(b);\n         // 相乘约束\n         if (a1[0].length !== b1.length) {\n            throw new Error();\n        }\n        let m = a1.length;\n        let p = a1[0].length;\n        let n = b1[0].length;\n    \n        // 初始化 m*n 全 0 二维数组\n        let c = new Array(m).fill(0).map(()=> new Array(n).fill(0));\n    \n        for (let i = 0; i < m; i++) {\n            for (let j = 0; j < n; j++) {\n                for (let k = 0; k < p; k++) {\n                    c[i][j] += a1[i][k] * b1[k][j];\n                }\n            }\n        }\n    \n        return [...c[0],...c[1],...c[2],...c[3]];\n    }\n    /**\n     * 将一维16位数组转换成4*4二维数组\n     * @param a \n     */\n     protected static tran(a: number[]):number[][] {\n        let arr: number[][] = []\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 4; j++) {\n                let index = i * 4 + j\n                if(!arr[i]) arr[i] = [];\n                arr[i][j] = a[index];\n            }\n        }\n        return arr;\n    }\n    /**\n     * 获得一个无效果的4x4矩阵\n     */\n    static getNullMatrix():number[]{\n        return [\n            1,0,0,0,\n            0,1,0,0,\n            0,0,1,0,\n            0,0,0,1\n        ]\n    }\n}","\nimport { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { deepMerge } from \"src/ts/util/deepMerge\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n\n\n/**\n * 动画组，用于多个动画并行播放\n */\nexport class GroupAnimations extends CubicAnimations {\n    animations: AnimationInterface[] = []\n    /**\n     * 每个动画结束的累计矩阵\n     */\n     cumulativeMatrix: number[][] = []\n    setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n        \n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])      \n        //计算出最大的动画时长\n        this.animations.forEach((val,key)=>{\n            let dur = val.getDuration()\n             //计算最后一帧\n            this.cumulativeMatrix[key] = val.getMatrix(dur) || Matrix.getNullMatrix();\n            if(dur > this.duration){\n               \n                //这里覆盖了父类的属性\n                //实际上，只有父类的时长不够，才会被更新\n                this.duration = val.getDuration();\n            }\n        })\n        \n        return true;\n    }\n    getCubicStyle(_progress: number,time:number): false | DanmakuStyle {\n        /**\n         * 合并样式，由于样式的特殊性，如果存在冲突的样式，后面的会覆盖前面的\n         */\n        let style:DanmakuStyle = {boxStyle:{},fontStyle:{}};\n        let noneStyle = true;\n        for(let i = 0;i<this.animations.length;i++){\n            let style2 = this.animations[i].getStyle(time)\n            if(style2){\n                noneStyle = false;\n                style = deepMerge(style,style2);\n            }\n           \n        }\n        if(noneStyle) return false;\n        return style;\n    }\n    getMatrixForCubic(_progress: number,time:number): false | number[] {\n        //建立一个空白矩阵\n        let arr:number[] = [\n            1,0,0,0,\n            0,1,0,0,\n            0,0,1,0,\n            0,0,0,1\n        ]\n        //倒着计算所有的矩阵\n        for(let i = this.animations.length - 1;i >= 0;i--){\n            let matrix = this.animations[i].getMatrix(time)\n            // console.log(matrix);\n            \n            if(matrix){\n                arr = Matrix.mult(arr,matrix);\n            }else{\n                arr = Matrix.mult(arr,this.cumulativeMatrix[i]);\n            }\n        }\n        \n        return arr;\n    }\n\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n/**\n * 动画列表组，所有动画按顺序播放\n */\nexport class ListAnimations extends CubicAnimations {\n    animations: AnimationInterface[] = []\n    /**\n     * 每个动画结束的累计矩阵\n     */\n    cumulativeMatrix: number[][] = []\n    cumulativeTime: number[] = []\n    setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])\n\n        let duration = 0;\n        this.cumulativeMatrix[0] = Matrix.getNullMatrix();\n        this.cumulativeTime[0] = duration\n\n        this.animations.forEach((val, key) => {\n            let dur = val.getDuration()\n\n\n            //自增1，因为0的结束帧的1的开头\n            key++\n            //计算出每个动画结束后的矩阵叠加,传入持续时间以获得最后一帧动画\n            let matrix = val.getMatrix(dur) || Matrix.getNullMatrix();\n            //叠加\n            this.cumulativeMatrix[key] =\n                Matrix.mult(matrix, this.cumulativeMatrix[key - 1])\n\n            duration += dur;\n            this.cumulativeTime[key] = duration\n\n        })\n        \n        if (this.duration < duration) { this.duration = duration; }\n\n        return true;\n    }\n\n    getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n        let curAnimation = this.getCurAnimation(time)\n\n        if (curAnimation) {\n            return curAnimation.animation.getStyle(time)\n        }\n        return false\n    }\n\n    getMatrixForCubic(_progress: number, time: number): false | number[] {\n\n\n        let curAnimation = this.getCurAnimation(time)\n\n        if (curAnimation) {\n\n            time = time - this.cumulativeTime[curAnimation.key]\n\n            let mat = curAnimation.animation.getMatrix(time) || Matrix.getNullMatrix()\n            return Matrix.mult(mat, this.cumulativeMatrix[curAnimation.key])\n        }\n        return false\n    }\n    /**\n     * 获取当前的动画元素,如果不存在则返回false\n     */\n    protected getCurAnimation(time: number): { key: number, animation: AnimationInterface } | false {\n\n        for (let i = this.animations.length - 1; i >= 0; i--) {\n            let duration = this.cumulativeTime[i]\n            if (time > duration) {\n                return { key: i, animation: this.animations[i] }\n            }\n        }\n        return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\n/**\n * 透明度动画\n *\n * @export\n * @class OpacityAnimations\n * @extends {CubicAnimations}\n */\nexport class OpacityAnimations extends CubicAnimations{\n    opacity:[number,number] = [0,1]\n    setParams(param?: { [idx: string]: any; }):boolean{\n        super.setParams(param);\n        this.opacity = param?.opacity || this.opacity\n        return true\n    }\n    getCubicStyle(progress: number, _time: number): false | DanmakuStyle {\n        return {\n            opacity:this.getProgressValue(this.opacity[0],this.opacity[1],progress)\n        }\n    }\n    getMatrixForCubic(_progress: number, _time: number): false | number[] {\n        return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\n\n/**\n * 静止动画 仅仅悬停在某一个位置一定时间\n */\nexport class StaticAnimation implements AnimationInterface {\n    getDuration(): number {\n        return this.duration;\n    }\n\n    duration: number = 1000;\n    x: number = 0;\n    y: number = 0;\n    z: number = 0;\n    setParams(param: { [idx: string]: any; }): boolean {\n        let def = 0;\n        this.duration = param?.duration || this.duration\n        this.x = param?.x || def\n        this.y = param?.y || def\n        this.z = param?.z || def\n        return true\n    }\n    getMatrix(time: number): false | number[] {\n        // console.log(time);\n\n        if (time > this.duration) return false;\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.x, this.y, this.z, 1\n        ]\n\n    }\n    getStyle(): false | DanmakuStyle {\n        return false\n    }\n\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { StaticAnimation } from \"../TransformsAnimations/StaticAnimation\";\n\nexport class RepeatAnimations extends CubicAnimations{\n    /**\n     * 动画接口\n     */\n    animation:AnimationInterface\n    /**\n     * 重复次数\n     */\n    repeat:number = 1\n    /**\n     * 单个动画时间\n     */\n    animationTime:number\n    getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n        return this.animation.getStyle(this.getCurTime(time))\n    }\n    getMatrixForCubic(_progress: number, time: number): false | number[] {\n        return this.animation.getMatrix(this.getCurTime(time))\n    }\n    setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n        \n        if(param?.animation){\n            this.animation =  AnimationFactory.getAnimations(param?.animation.type,param?.animation.params) || new StaticAnimation()\n           \n        }else{\n            this.animation = new StaticAnimation()\n        }\n        \n        console.log(this.animation);\n        \n        this.repeat = param?.repeat || this.repeat\n        this.animationTime = this.animation.getDuration()\n        //覆盖父级存活时间 \n        //计算方式 单个弹幕时间 X 弹幕重复次数\n        this.duration = this.animationTime * this.repeat\n        console.log(this.duration);\n        \n        return true\n    }\n    /**\n     * 获得当前的弹幕时间\n     */\n    getCurTime(time:number){\n        //取余\n        return time % this.animationTime\n    }\n}","import { CubicAnimations } from \"./CubicAnimations\";\nimport { Matrix } from \"./Matrix\";\n\n/**\n * 可改变动画中心点的动画\n *\n * @export\n * @abstract\n * @class OriginAnimations\n * @extends {CubicAnimations}\n */\nexport abstract class OriginAnimations extends CubicAnimations {\n    origin:number[] = [0,0,0]\n    setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) return false;\n        this.origin =  param?.origin || this.origin\n        return true\n    }\n    getMatrixForCubic(progress: number): number[] | false{\n        let arr = this.getMatrixForOrigin(progress)\n        if(!arr) return false\n        arr = Matrix.mult([\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            -this.origin[0], -this.origin[1], -this.origin[2], 1\n\n        ],arr)\n        return Matrix.mult(arr,[\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.origin[0], this.origin[1], this.origin[2], 1\n\n        ])\n    }\n    /**\n     * 获取用于计算原坐标点的矩阵\n     * @param progress \n     */\n    abstract getMatrixForOrigin(progress: number): number[] | false\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 缩放动画\n */\nexport class ScaleAnimations extends OriginAnimations{\n    scale:{x1:number,y1:number,z1:number,x2:number,y2:number,z2:number} \n    = {x1:1,y1:1,z1:1,x2:1,y2:1,z2:1}\n    setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) return false;\n        this.scale = Object.assign(this.scale,param?.scale)\n        return true\n    }\n    getMatrixForOrigin(progress: number): false | number[] {\n        let x = this.getProgressValue(this.scale.x1, this.scale.x2, progress);\n        let y = this.getProgressValue(this.scale.y1, this.scale.y2, progress)\n        let z = this.getProgressValue(this.scale.z1, this.scale.z2, progress)\n        let m = [\n            x,0,0,0,\n            0,y,0,0,\n            0,0,z,0,\n            0,0,0,1\n        ]\n        return m\n\n    }\n    getCubicStyle(_progress: number): false | DanmakuStyle {\n       return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\nexport class TranslateAnimation extends CubicAnimations {\n\n    path: { x1: number, y1: number, z1: number, x2: number, y2: number, z2: number }\n        =\n        { x1: 0, y1: 0, x2: 0, y2: 0, z1: 0, z2: 0 }\n    setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) return false;\n        this.path = Object.assign(this.path,param?.path)\n        return true\n    }\n    getCubicStyle(): false | DanmakuStyle {\n        return false;\n    }\n    getMatrixForCubic(progress: number): false | number[] {\n        // console.log(this.path);\n        // console.log(progress);\n\n        let x = this.getProgressValue(this.path.x1, this.path.x2, progress);\n        let y = this.getProgressValue(this.path.y1, this.path.y2, progress)\n        let z = this.getProgressValue(this.path.z1, this.path.z2, progress)\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            x, y, z, 1\n        ]\n    }\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 旋转父类\n */\nexport abstract class RotationAnimation extends OriginAnimations {\n\n    angle:{start:number,end:number} = {start:0,end:360}\n    setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) return false;\n        this.angle = Object.assign(this.angle,param?.angle)\n        return true\n    }\n    getCubicStyle(_progress: number): false | DanmakuStyle {\n        return false;\n    }\n    /**\n     * 角度转弧度\n     */\n    protected A2R(a: number) {\n        return a * (Math.PI / 180)\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * X轴旋转\n */\nexport class RotationXAnimation extends RotationAnimation {\n    getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            1, 0, 0, 0,\n            0, cos, sin, 0,\n            0, -sin, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n/**\n * y轴旋转\n */\nexport class RotationYAnimation extends RotationAnimation {\n    getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos, 0, sin, 0,\n            0, 1, 0, 0,\n            -sin, 0, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * z轴旋转\n */\nexport class RotationZAnimation extends RotationAnimation {\n    getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos,sin, 0, 0,\n            -sin, cos, 0, 0,\n            0, 0,1, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { AnimationInterface } from \"../core/Animation/Base/AnimationInterface\";\nimport { GroupAnimations } from \"../core/Animation/CompositeAnimation/GroupAnimations\";\nimport { ListAnimations } from \"../core/Animation/CompositeAnimation/ListAnimations\";\nimport { OpacityAnimations } from \"../core/Animation/styleAnimations/OpacityAnimations\";\nimport { RepeatAnimations } from \"../core/Animation/CompositeAnimation/RepeatAnimations\";\nimport { ScaleAnimations } from \"../core/Animation/TransformsAnimations/ScaleAnimations\";\nimport { TranslateAnimation } from \"../core/Animation/TransformsAnimations/TranslateAnimation\";\nimport { RotationXAnimation } from \"../core/Animation/TransformsAnimations/RotationXAnimation\";\nimport { RotationYAnimation } from \"../core/Animation/TransformsAnimations/RotationYAnimation\";\nimport { RotationZAnimation } from \"../core/Animation/TransformsAnimations/RotationZAnimation\";\nimport { StaticAnimation } from \"../core/Animation/TransformsAnimations/StaticAnimation\";\n\nexport class AnimationFactory {\n    static animationList = {\n        \"static\":StaticAnimation,//静态定位\n        \"translate\":TranslateAnimation,//平移\n        \"rotateX\":RotationXAnimation,// x轴旋转\n        \"rotateY\":RotationYAnimation,//y轴旋转\n        \"rotateZ\":RotationZAnimation,//z轴旋转\n        \"scale\":ScaleAnimations,//缩放\n        \"list\":ListAnimations,//动画列表\n        \"group\":GroupAnimations,//动画组\n        \"repeat\":RepeatAnimations,//重复动画\n        \"opacity\":OpacityAnimations\n    }\n\n    static getAnimations(type:string,params):AnimationInterface | false{\n        if(this.animationList[type]){\n            // console.log(params);\n            let ani = new this.animationList[type]()\n            // console.log(ani);\n            \n            ani.setParams(params)\n            return ani;\n        }\n        return false;\n    }\n    static getAnimationsList(list:{key: { [idx: string]: any; }}[]):AnimationInterface[]{\n        let animationList:AnimationInterface[] = []\n        \n        list?.forEach((val)=>{\n            let ani =  this.getAnimations(val[\"type\"],val)\n            if(ani){\n                animationList.push(ani);\n            }\n        })\n        return animationList\n    }\n}","import { DanmakuStyle } from \"../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"./DanmakuItemInterface\";\nimport { StaticAnimation } from \"../Animation/TransformsAnimations/StaticAnimation\";\n\n/**\n * 基础弹幕类型\n */\nexport class BaseDanmaku implements DanmakuItemInterface {\n\n\n    style:DanmakuStyle = {}\n    start:number = 0;\n    animation?:AnimationInterface\n    content:string = \"\"\n    child:DanmakuItemInterface[] = []\n    /**\n     * 设置参数\n     * @param param \n     * @returns \n     */\n    setParams(param: { [idx: string]: any; }): boolean {\n        //设置文字样式\n        try{\n            //设置开始时间\n            param?.start &&　(this.start = param?.start)\n            param?.animation && (this.animation =  param?.animation ||  new StaticAnimation())\n            param?.child && (this.child = param.child)\n            param?.style && (this.style = param?.style)\n            param?.content && (this.content = param?.content)\n\n            \n        }catch(e){\n            console.warn(e);\n            return false;\n        }\n       \n        return true\n    }\n    getType(): string {\n        return \"base\"\n    }\n    getContent(): string {\n        return this.content\n    }\n    getChild(): DanmakuItemInterface[] {\n        return this.child\n    }\n    getAnimation(): AnimationInterface {\n        if(!this.animation){\n            this.animation = new StaticAnimation()\n        }\n        return this.animation\n    }\n    getStyle(): DanmakuStyle {\n        return this.style\n    }\n    startTime(): number {\n        return this.start\n    }\n}\n\n","import { BaseDanmaku } from \"src/ts/core/Danmaku/BaseDanmaku\";\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\n\nexport class DanmakuFactory{\n    static list = {\n        \"text\":BaseDanmaku\n    }\n    static getDanmakuInstance(type:string):DanmakuItemInterface{\n        if(!this.list[type]){\n            type = \"text\"\n        }\n        return new this.list[type]()\n    }\n}","import { i18n } from \"src/ts/i18n\";\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\nimport { AnimationFactory } from \"../AnimationFactory\";\nimport { DanmakuFactory } from \"./DanmakuFactory\";\nimport { DanmakuParserInterface } from \"./DanmakuParserInterface\";\n\nexport class JsonDanmakuParser implements DanmakuParserInterface {\n\n    parser(content: string): DanmakuItemInterface[] {\n        try {\n            let json: any[] = JSON.parse(content)\n            \n            return this.getDanmaku(json);\n        } catch (e) {\n            console.warn(i18n.t(\"Danmaku parser fail\"))\n            console.warn(e);\n            return []\n        }\n\n    }\n\n    getDanmaku(obj?: any[]):DanmakuItemInterface[] {\n        let list:DanmakuItemInterface[] = []\n\n        obj?.forEach((dan) => {\n            \n            let danmaku = DanmakuFactory.getDanmakuInstance(dan.type)\n            if(!dan?.animations || dan?.animations === []){\n                dan.animations = [{type:\"static\"}]\n            } \n            danmaku.setParams({\n                start: dan?.start,\n                content:dan?.content,\n                style:dan?.style,\n                animation: AnimationFactory.getAnimations(\"list\",{animations:dan?.animations}),//将列表组成一个list\n                child:this.getDanmaku(dan.childs)\n            })\n\n            list.push(danmaku);\n        })\n        return list;\n\n    }\n}","\nimport { SizeInterface } from \"../core/Style/SizeInterface\";\nimport { StageInterface } from \"../core/Stage/StageInterface\";\nimport { Context } from \"../Context/Context\";\nimport { i18n } from \"../i18n\";\nimport { canvasStyle } from \"../core/Style/CanvasStyle\";\nimport { RendererFactory } from \"src/ts/Factory/RendererFactory\";\nimport { PxSize } from \"../core/Style/Unit/PxSize\";\nimport { TimeLineFactory } from \"../Factory/TimeLineFactort\";\nimport { JsonDanmakuParser } from \"../Factory/DanmakuParser/JsonDanmakuParser\";\n\n/**\n * 控制器 ，统一管理整个弹幕系统\n * 在这里，每种弹幕类型都会得到一个舞台对象，进行渲染\n */\nexport class Controller {\n    /**\n     * 画布对象\n     */\n    protected containers: HTMLElement;\n    /**\n     * 实时的Css样式表\n     */\n    protected canvasStyle: CSSStyleDeclaration;\n    /**\n     * 舞台列表\n    */\n    protected stageList: StageInterface[] = [];\n    /**\n     * 暂停状态\n     */\n    protected pauseStatus: boolean = true;\n    /**\n     * 时间戳\n     */\n    protected timeStamp: number = 0;\n    /**\n     * 播放的时间\n     */\n    protected time: number = 0;\n    /**\n     * 跳转状态\n     */\n    skipStatus: boolean = false;\n\n    protected danmakuFunction: { [type: string]: (send: (str: string[]) => void) => void } = {}\n    constructor(containers: HTMLElement) {\n        this.containers = containers\n        //获取实时的style对象，当大小发生变化时，会更新自身\n        this.canvasStyle = window.getComputedStyle(containers);\n        //初始化容器\n        this.initContainer()\n        let that = this;\n        (function animloop() {\n\n            if (!that.pauseStatus) {\n                that.refresh()\n            }\n            requestAnimationFrame(animloop);\n\n\n        })()\n    }\n    /**\n     * 获得容器尺寸\n     */\n    public getContainersSize(): SizeInterface {\n        return {\n            width: new PxSize(parseInt(this.canvasStyle.width)),\n            height: new PxSize(parseInt(this.canvasStyle.height))\n        }\n    }\n    /**\n     * 将一个舞台添加到容器内\n     * @param stage 舞台\n     * @param index 排列顺序\n     * @returns 成功与失败的状态\n     */\n    public registStage(stage: StageInterface, index: number): boolean {\n        //检查列表中是否存在\n        if (this.stageList[index]) {\n            return false;\n        }\n        this.stageList[index] = stage;\n        return true;\n    }\n    /**\n     * 将舞台挂载到容器中\n     */\n    public mount() {\n        console.info(i18n.t(\"Start mount stage\"));\n        //遍历每一个舞台\n        this.stageList.forEach((stage,key) => {\n            //获取一个div\n            let div = this.getDIV()\n            //给舞台初始化渲染器\n            let render = RendererFactory.getRenderInstance(stage.rendererType());\n            //将div挂载到渲染器\n            render.setCanvasContainer(div)\n            //设置舞台渲染器\n            stage.stageRenderer(render);\n            //设置舞台时间轴\n            let lineType = stage.timeLineType()\n            let timeline = TimeLineFactory.getTimeLine(lineType)\n            stage.timeLine(timeline)\n            //检察是否存在弹幕获取器\n            if (this.danmakuFunction[lineType]) {\n                //如果存在，就获取弹幕\n                    this.resetDanmaku(key)\n            } else {\n                console.warn(i18n.t(\"danmaku get function is null :\" + lineType));\n            }\n            \n            //更新渲染器内画布样式\n            render.updateCanvasStyle(this.getCanvasStylByStage(stage))\n        })\n       \n    }\n\n    /**\n     * 初始化弹幕容器\n     */\n    protected initContainer() {\n        if (Context.debug) {\n            //debug模式\n            this.containers.classList.add(\"danmaku-containers-debug\")\n        }\n        this.containers.classList.add(\"danmaku-containers\")\n\n    }\n\n    /**\n     * 重置尺寸\n     */\n    public resize() {\n        //重置舞台的尺寸\n        this.stageList.forEach((stage) => {\n            let render = stage.getRenderer()\n            if (render) {\n                render.updateCanvasStyle(this.getCanvasStylByStage(stage));\n            }\n        })\n    }\n    /**\n     * 创建div容器 \n     */\n    protected getDIV(): HTMLElement {\n        let div = document.createElement(\"div\");\n        div.classList.add(\"stage\")\n        this.containers.appendChild(div);\n        return div;\n    }\n\n    /**\n     * 根据舞台对象创建一个canvasStyle\n     * @param stage 舞台对象\n     * @returns \n     */\n    protected getCanvasStylByStage(stage: StageInterface): canvasStyle {\n        let size = stage.stageSize(this.getContainersSize())\n        let color = stage.stageBackgroundColor(this.getContainersSize())\n        let pos = stage.stagePosition(this.getContainersSize(), size)\n        return { position: pos, color: color, size: size }\n    }\n\n    refresh() {\n\n        this.time = Date.now() - this.timeStamp\n        //通知每个舞台刷新\n        this.stageList.forEach((stage) => {\n            // console.log(1)\n            stage.refresh(this.time)\n        })\n    }\n\n    /**\n     * 暂停\n     */\n    pause() {\n        if (!this.pauseStatus) {\n            this.pauseStatus = true;\n        }\n    }\n    /**\n     * 播放\n     */\n    start() {\n        if (this.pauseStatus) {\n            //同步时间\n            this.timeStamp = Date.now() - this.time;\n            this.pauseStatus = false;\n        }\n    }\n    /**\n     * 跳转\n     */\n    skip(time: number) {\n        if (this.pauseStatus) {\n            //如果是暂停状态\n            this.time = time;\n        } else {\n            //否则使用这个方法\n            this.timeStamp = Date.now() - time\n        }\n    }\n    /**\n     * 重置整个系统\n     */\n    reset() {\n        //清空所有舞台\n        this.stageList.forEach((stage) => {\n            stage.reset()\n        })\n        this.pauseStatus = true\n        this.timeStamp = 0\n        this.time = 0\n        this.skipStatus = false\n    }\n    getTime() {\n        return this.time\n    }\n    addGetDanmakuFunction(type: string, fun: (send: (str: string[]) => void) => void) {\n        this.danmakuFunction[type] = fun\n    }\n    resetDanmaku(type:number){\n        if(this.stageList[type]){\n            let stage = this.stageList[type]\n            stage.getTimeLine().reset();\n            let lineType = stage.timeLineType();\n            let fun = this.danmakuFunction[lineType]\n            if(!!fun){\n                fun((res:string[])=>{\n                    let parser = new JsonDanmakuParser();\n                    let timeline = stage.getTimeLine()\n                    res.forEach((danmakuStr:string)=>{\n                        parser.parser(danmakuStr).forEach((danmaku) => {\n                            timeline.addDanmaku(danmaku)\n                        });\n                    })\n                })\n            }\n        }\n    }\n}","import { UnitInterface } from \"./UnitInterface\"\n\n/**\n * 颜色接口\n */\n\nexport class Color implements UnitInterface {\n    r: number\n    g: number\n    b: number\n    a: number\n    constructor(r:number, g:number, b:number, a:number) {\n        this.r = r\n        this.g = g\n        this.b = b\n        this.a = a\n    }\n    string(): string {\n        return \"rgba(\" + this.r + \",\" + this.g + \",\" + this.b + \",\" + this.a + \")\"\n    }\n    /**\n     * 常见颜色表\n     */\n    protected static color:{[key:string]:[number,number,number,number]} = {\n        \"black\":[0,0,0,1],\n        \"white\":[255,255,255,1],\n        \"red\":[255,0,0,1],\n        \"green\":[0,255,0,1],\n        \"blue\":[0,0,255,1],\n        \"pink\":[255,105,108,1],\n        \"yellow\":[255,255,0,1],\n        \"grey\":[130,130,130,1]\n    }\n    /**\n     * 获取预设颜色\n     * @param color 颜色名称\n     * @returns \n     */\n    static getColor(color:string):Color{\n        if(this.color[color]){\n            return new this(...this.color[color])\n        }else{\n            return new this(...this.color[\"black\"])\n        }\n        \n    }\n}","import { RendererInterface } from \"../Renderer/RendererInterface\";\nimport { Color } from \"../Style/Unit/Color\";\nimport { PositionInterface } from \"../Style/PositionInterface\";\nimport { SizeInterface } from \"../Style/SizeInterface\";\nimport { StageInterface } from \"./StageInterface\";\nimport { PxSize } from \"../Style/Unit/PxSize\";\nimport { TimeLineInterface } from \"src/ts/TimeLine/TimeLineInterface\";\nimport { i18n } from \"src/ts/i18n\";\nimport { TimeLineDanmaku } from \"src/ts/TimeLine/TimeLineDanmaku\";\n\nexport abstract class BaseStage implements StageInterface {\n\n\n    protected renderer?: RendererInterface;\n    protected timeLineObj?: TimeLineInterface\n    stageSize(containersSize: SizeInterface): SizeInterface {\n        return {\n            width: containersSize.width,\n            height: containersSize.height\n        }\n    }\n    stagePosition(): PositionInterface {\n        return {\n            x:new PxSize(0),\n            y:new PxSize(0)\n        }\n    }\n    stageBackgroundColor(): Color {\n        return  new Color(0,0,0,0);\n    }\n    stageRenderer(render: RendererInterface): boolean {\n        this.renderer = render\n        return true;\n    }\n    getRenderer(): RendererInterface {\n        if(this.renderer){\n            return this.renderer\n        }else{\n            throw ReferenceError(i18n.t(\"renderer is null\"))\n        }\n        \n    }\n    timeLine(timeLine: TimeLineInterface): boolean {\n        this.timeLineObj = timeLine;\n        return true;\n    }\n    refresh(time:number):boolean{\n        if(!this.renderer) return false;\n        let list:{ skip: boolean; DanmakuList: TimeLineDanmaku[]; }\n        if(list = this.timeLineObj?.getDanmakuList(time) || {skip:false,DanmakuList:[]}){\n            if(list.skip){\n                // console.log(list.skip);\n\n                \n                this.renderer?.reset()\n            }\n            \n            list.DanmakuList.forEach((val)=>{ \n                this.renderer?.addDanmaku(val.danmaku)\n            })\n        }\n        this.renderer.refresh(time)\n        return true\n    }\n    rendererType(): string {\n        return \"css3\"\n    }\n    timeLineType(): string {\n        return \"advance\"\n    }\n\n    reset(): boolean {\n        this?.renderer?.reset()\n        return true\n    \n    }\n    getTimeLine(): TimeLineInterface {\n        if(!this.timeLineObj){\n            throw ReferenceError(i18n.t(\"Time line is null\"));\n        }\n        return this.timeLineObj\n    }\n   \n}","\nimport { BaseStage } from \"./BaseStage\";\n\n\nexport class TestStage extends BaseStage{\n\n}","import \"../css/base.css\";\nimport { Controller } from './Controller/Controller';\nimport { i18n } from \"./i18n\"\nimport { InitConfigInterface } from \"./core/InitConfigInterface\";\nimport { TestStage } from \"./core/Stage/TestStage\";\nexport  class MFADE {\n\n    controller:Controller; \n    constructor(config: InitConfigInterface) {\n        //类型检查\n        if (!config.containers) {\n            throw ReferenceError(i18n.t(\"Containers is null\"))\n        }\n        this.controller = new Controller(config.containers)\n        this.controller.addGetDanmakuFunction(\"advance\",config.danmaku)\n        this.controller.registStage(new TestStage(), 1)\n        this.controller.mount()\n        //监听大小变化\n        // window.addEventListener(\"resize\", () => {\n        //     this.controller.resize()\n        // })\n    }\r\n\t\n    pause(){\n        this.controller.pause()\n    }\n    start(){\n        this.controller.start()\n    }\n    skip(time:number){\n        this.controller.skip(time)\n    }\n    time(){\n        return this.controller.getTime()\n    }\r\n\tresize(){\r\n\t\tthis.controller.resize()\r\n\t}\n    reset(){\n        this.controller.resetDanmaku(1)\n        this.controller.reset()\n    }\n\n}\n\n//添加进全局\nif (typeof globalThis !== \"undefined\") {\n    globalThis.MFADE = MFADE;\n}else{\n    window[\"MFADE\"] = MFADE;\n}\n"],"sourceRoot":""}