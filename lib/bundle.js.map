{"version":3,"sources":["webpack://mf-ade/./node_modules/css-loader/dist/runtime/api.js","webpack://mf-ade/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://mf-ade/./src/css/base.css","webpack://mf-ade/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://mf-ade/webpack/bootstrap","webpack://mf-ade/webpack/runtime/compat get default export","webpack://mf-ade/webpack/runtime/define property getters","webpack://mf-ade/webpack/runtime/hasOwnProperty shorthand","webpack://mf-ade/./src/css/base.css?6b6c","webpack://mf-ade/./src/ts/Context/Context.ts","webpack://mf-ade/./src/ts/i18n/zh-cn.ts","webpack://mf-ade/./src/ts/i18n/index.ts","webpack://mf-ade/./src/ts/core/Renderer/BaseRenderer.ts","webpack://mf-ade/./src/ts/util/UnitTools.ts","webpack://mf-ade/./src/ts/core/Style/Unit/PxSize.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CssDanmakuObj.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CSS3Renderer.ts","webpack://mf-ade/./src/ts/Factory/RendererFactory.ts","webpack://mf-ade/./src/ts/TimeLine/AdvancedLine.ts","webpack://mf-ade/./src/ts/Factory/TimeLineFactort.ts","webpack://mf-ade/./src/ts/util/deepMerge.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Cubic.ts","webpack://mf-ade/./src/ts/core/Animation/Base/CubicAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Matrix.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/GroupAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/ListAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/styleAnimations/OpacityAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/StaticAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/RepeatAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/OriginAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/ScaleAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/TranslateAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationXAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationYAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationZAnimation.ts","webpack://mf-ade/./src/ts/Factory/AnimationFactory.ts","webpack://mf-ade/./src/ts/core/Danmaku/BaseDanmaku.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/DanmakuFactory.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/JsonDanmakuParser.ts","webpack://mf-ade/./src/ts/Controller/Controller.ts","webpack://mf-ade/./src/ts/core/Style/Unit/Color.ts","webpack://mf-ade/./src/ts/core/Stage/BaseStage.ts","webpack://mf-ade/./src/ts/core/Stage/TestStage.ts","webpack://mf-ade/./src/ts/index.ts"],"names":["module","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","n","prototype","call","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","___CSS_LOADER_EXPORT___","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","defineProperty","enumerable","get","prop","hasOwnProperty","language","debug","t","str","tranTxt","Context","reset","addDanmaku","_danmaku","refresh","setCanvasContainer","canvas","updateCanvasStyle","width","size","string","height","left","position","x","top","y","backgroundColor","color","lengthSrting","num","Matrix3dString","SyntaxError","i18n","recursionDanmaku","danmaku","danmakuobj","div","createDiv","getContent","setStyle","getStyle","childObj","element","animation","getAnimation","child","start","startTime","getChild","innerText","recursionDiv","array","ele","assign","recursionStyle","abstime","parentTime","dan","sty","max","time","getMatrix","transform","UnitTools","parentElement","canvasSize","PxSize","danmakuList","r","DanmakuTool","innerHTML","getRenderInstance","type","rendererList","ReferenceError","BaseRenderer","css3","CSS3Renderer","lastTime","end","getDuration","timeToIndex","Math","floor","getDanmakuList","skip","DanmakuList","timeIndex","l","getTimeLine","AdvancedLine","deepMerge","obj1","obj2","b","c","px3","px2","px1","py3","py2","py1","epsilon","getX","getY","solve","g","abs","cubic","duration","isEnd","p","getProgress","getMatrixForCubic","getCubicStyle","setParams","param","progress","getCubic","getProgressValue","cubicFunc","Cubic","add","sub","mult","a1","tran","b1","m","fill","j","k","getNullMatrix","animations","cumulativeMatrix","AnimationFactory","getAnimationsList","val","dur","Matrix","_progress","boxStyle","fontStyle","noneStyle","style2","matrix","CubicAnimations","cumulativeTime","curAnimation","getCurAnimation","mat","opacity","_time","z","repeat","getCurTime","getAnimations","params","StaticAnimation","console","log","animationTime","origin","getMatrixForOrigin","scale","x1","y1","z1","x2","y2","z2","OriginAnimations","path","angle","A2R","PI","sin","cos","RotationAnimation","animationList","ani","TranslateAnimation","RotationXAnimation","RotationYAnimation","RotationZAnimation","ScaleAnimations","ListAnimations","GroupAnimations","RepeatAnimations","OpacityAnimations","warn","getType","getDanmakuInstance","BaseDanmaku","parser","json","parse","getDanmaku","DanmakuFactory","childs","containers","stageList","pauseStatus","timeStamp","skipStatus","danmakuFunction","canvasStyle","getComputedStyle","initContainer","that","animloop","requestAnimationFrame","getContainersSize","parseInt","registStage","stage","mount","info","getDIV","render","RendererFactory","rendererType","stageRenderer","lineType","timeLineType","timeline","TimeLineFactory","timeLine","resetDanmaku","getCanvasStylByStage","classList","resize","getRenderer","stageSize","stageBackgroundColor","stagePosition","Date","now","pause","getTime","addGetDanmakuFunction","fun","res","JsonDanmakuParser","danmakuStr","getColor","containersSize","Color","renderer","timeLineObj","BaseStage","config","controller","Controller","TestStage","addEventListener","globalThis","MfunsDanMaku"],"mappings":"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","file":"bundle.js","sourcesContent":["\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".danmaku-containers{\\r\\n    position: relative;\\r\\n}\\r\\n.danmaku-containers  *{\\r\\n    box-sizing: border-box;\\r\\n    transform-style: preserve-3d;\\r\\n    margin: 0;\\r\\n    padding: 0;\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n    font-size: 100px;\\r\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\r\\n}\\r\\n.danmaku-containers .stage{\\r\\n    position: absolute;\\r\\n    overflow: hidden;\\r\\n    perspective:1000px;\\r\\n    transform-style: preserve-3d;\\r\\n}\\r\\n.danmaku-containers-debug *{\\r\\n    outline: 1px solid red;\\r\\n}\\r\\n\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/base.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;IACtB,4BAA4B;IAC5B,SAAS;IACT,UAAU;IACV,yCAAyC;IACzC,gBAAgB;IAChB,0BAA0B,EAAE,gBAAgB;AAChD;AACA;IACI,kBAAkB;IAClB,gBAAgB;IAChB,kBAAkB;IAClB,4BAA4B;AAChC;AACA;IACI,sBAAsB;AAC1B\",\"sourcesContent\":[\".danmaku-containers{\\r\\n    position: relative;\\r\\n}\\r\\n.danmaku-containers  *{\\r\\n    box-sizing: border-box;\\r\\n    transform-style: preserve-3d;\\r\\n    margin: 0;\\r\\n    padding: 0;\\r\\n    font-family: Arial, Helvetica, sans-serif;\\r\\n    font-size: 100px;\\r\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\r\\n}\\r\\n.danmaku-containers .stage{\\r\\n    position: absolute;\\r\\n    overflow: hidden;\\r\\n    perspective:1000px;\\r\\n    transform-style: preserve-3d;\\r\\n}\\r\\n.danmaku-containers-debug *{\\r\\n    outline: 1px solid red;\\r\\n}\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./base.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/**\r\n * 全局上下文\r\n */\r\nexport class Context{\r\n    /**\r\n     * 当前语言\r\n     */\r\n    public static language:string = \"zh-cn\";\r\n    public static debug = false;\r\n}\r\n\r\n","export default {\r\n    \"Containers is null\" : \"容器为空\",\r\n    \"Start mount stage\" : \"开始挂载舞台\",\r\n    \"Renderer type is null\": \"没有找到合适的渲染器\",\r\n    \"matrix3d param less than 16\":\"matrix3d 参数小于16个\",\r\n}","import { Context } from \"../Context/Context\";\r\nimport zhCn from \"./zh-cn\";\r\n/**\r\n * i18n 国际化函数\r\n */\r\nexport class i18n {\r\n    private static tranTxt = {\r\n        \"zh-cn\": zhCn\r\n    }\r\n    /**\r\n     * 当前语言\r\n     */\r\n    private static language: string = Context.language;\r\n    /**\r\n     * 获取翻译，如果不存在，则返回自身\r\n     * @param str 需要国际化的字符串\r\n     * @returns 翻译结果\r\n     */\r\n    public static t(str: string): string {\r\n        //检查字符串是否存在\r\n        if (this.tranTxt[this.language] && this.tranTxt[this.language][str]) {\r\n            return this.tranTxt[this.language][str];\r\n        }\r\n        return str;\r\n    }\r\n}","\r\n\r\nimport { DanmakuItemInterface } from \"../Danmaku/DanmakuItemInterface\";\r\nimport { canvasStyle } from \"../Style/CanvasStyle\";\r\nimport { RendererInterface } from \"./RendererInterface\";\r\n\r\nexport class BaseRenderer implements RendererInterface {\r\n    reset(): boolean {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    addDanmaku(_danmaku: DanmakuItemInterface): boolean {\r\n        return false;\r\n    }\r\n    refresh(): boolean {\r\n        return false\r\n    }\r\n    protected canvas?: HTMLElement\r\n    setCanvasContainer(canvas: HTMLElement): boolean {\r\n        this.canvas = canvas\r\n        return true\r\n    }\r\n    updateCanvasStyle(style: canvasStyle): boolean {\r\n        if (this.canvas) {\r\n            this.canvas.style.width = style.size.width.string();\r\n            this.canvas.style.height = style.size.height.string();\r\n            this.canvas.style.left = style.position.x.string()\r\n            this.canvas.style.top = style.position.y.string()\r\n            this.canvas.style.backgroundColor = style.color.string()\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n}","import { i18n } from \"../i18n\";\r\n\r\nexport class UnitTools{\r\n    /**\r\n     * 拼接带单位的长度字符串\r\n     * @param num 长度\r\n     * @returns \r\n     */\r\n    static lengthSrting(num:number):string{\r\n        return num + \"px\";\r\n    }\r\n    /**\r\n     * 拼接 Matrix3d() 字符串\r\n     * @param arr 16位数字\r\n     */\r\n    static Matrix3dString(arr:Array<number>):string{\r\n        if(arr.length != 16){\r\n            throw SyntaxError(i18n.t(\"matrix3d param less than 16\"));\r\n        }\r\n        return \"Matrix3d(\" + arr.join(\",\") + \")\";\r\n    }\r\n    // static UnitFactory(type:string,obj):string{\r\n\r\n    // }\r\n}","import { UnitInterface } from \"./UnitInterface\";\r\n\r\nexport class PxSize implements UnitInterface{\r\n    length:number\r\n    constructor(length:number){\r\n        this.length = length;\r\n    }\r\n    string(): string {\r\n        return this.length +\"px\";\r\n    }\r\n\r\n}","import { UnitTools } from \"src/ts/util/UnitTools\";\r\nimport { AnimationInterface } from \"../../Animation/Base/AnimationInterface\";\r\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\r\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\n\r\nexport interface DanmakuObj {\r\n    element: HTMLElement,\r\n    style: DanmakuStyle\r\n    animation: AnimationInterface\r\n    child: DanmakuObj[]\r\n    start:number\r\n}\r\nexport class DanmakuTool {\r\n    /**\r\n   * 递归构建弹幕对象\r\n   * @param danmaku \r\n   * @returns \r\n   */\r\n    static recursionDanmaku(danmaku: DanmakuItemInterface[]): DanmakuObj[] {\r\n        let danmakuobj: DanmakuObj[] = []\r\n        danmaku.forEach((danmaku) => {\r\n            let div = this.createDiv(danmaku.getContent())\r\n            this.setStyle(div,danmaku.getStyle());\r\n            let obj: DanmakuObj = {\r\n                element: div,\r\n                animation: danmaku.getAnimation(),\r\n                style: danmaku.getStyle(),\r\n                child: [],\r\n                start:danmaku.startTime()\r\n            }\r\n            let child = danmaku.getChild()\r\n            let childObj;\r\n            if (child) {\r\n                childObj = this.recursionDanmaku(child)\r\n            }\r\n\r\n            obj.child = childObj;\r\n            danmakuobj.push(obj);\r\n        })\r\n        return danmakuobj\r\n    }\r\n    /**\r\n     * 创建一个空div\r\n     * @param content \r\n     * @returns \r\n     */\r\n    static createDiv(content: string): HTMLElement {\r\n        let div = document.createElement(\"div\");\r\n        div.style.position = \"absolute\"\r\n        div.innerText = content\r\n        return div\r\n    }\r\n    \r\n    /**\r\n     * 递归构建element\r\n     * @param danmakuobj \r\n     * @returns \r\n     */\r\n     static recursionDiv(danmakuobj:DanmakuObj[]):HTMLElement[]{\r\n        let array:Array<HTMLElement> = []\r\n        danmakuobj.forEach((item)=>{\r\n            let element = item.element;\r\n            if (item.child){\r\n                let eles = this.recursionDiv(item.child)\r\n                eles.forEach((ele)=>{\r\n                    element.appendChild(ele);\r\n                })\r\n            }\r\n            array.push(element);\r\n        })\r\n        return array\r\n    }\r\n    /**\r\n     * 将样式设置到元素中\r\n     */\r\n    static setStyle(element:HTMLElement,style:{ [idx: string]: any; }){\r\n        Object.assign(element.style,style)\r\n    }\r\n    /**\r\n     * 递归设置弹幕动画\r\n     * @param danmaku \r\n     */\r\n    static recursionStyle(danmaku:DanmakuObj[],canvas:HTMLElement,abstime:number,parentTime:number = 0){ \r\n        danmaku.forEach((dan,key)=>{\r\n            //更新弹幕样式\r\n            let time = parentTime == 0 ? abstime - dan.start: parentTime - dan.start;\r\n            \r\n            // console.log(dan.animation);\r\n            \r\n            let sty;\r\n            let max;\r\n            if(sty = dan.animation.getStyle(time)){\r\n            \r\n                this.setStyle(dan.element,sty)\r\n            }\r\n            if(max = dan.animation.getMatrix(time)){\r\n                dan.element.style.transform = UnitTools.Matrix3dString(max);\r\n            }\r\n            \r\n            //如果都不存在，则表示动画已经完成，销毁元素\r\n            //如果是子元素的情况，有可能存在弹幕未开始的情况\r\n            if(!(sty || max)){\r\n                \r\n                \r\n                if(dan.element.parentElement){\r\n                    //从父元素删除节点\r\n                    dan.element.parentElement.removeChild(dan.element)\r\n                }else{\r\n                    //否则从canvas里面删除\r\n                    canvas.removeChild(dan.element);\r\n                }\r\n                //并且清空节点\r\n                delete danmaku[key];\r\n            }\r\n            //递归\r\n            this.recursionStyle(dan.child,canvas,abstime,time);\r\n        })\r\n    }\r\n}","import { UnitTools } from \"src/ts/util/UnitTools\";\r\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\r\nimport { canvasStyle } from \"../../Style/CanvasStyle\";\r\nimport { SizeInterface } from \"../../Style/SizeInterface\";\r\nimport { PxSize } from \"../../Style/Unit/PxSize\";\r\nimport { RendererInterface } from \"../RendererInterface\";\r\nimport { DanmakuObj, DanmakuTool } from \"./CssDanmakuObj\";\r\n\r\n\r\nexport class CSS3Renderer implements RendererInterface {\r\n\r\n    canvasSize: SizeInterface = {\r\n        width: new PxSize(1920),\r\n        height: new PxSize(1080)\r\n    }\r\n    canvas?: HTMLElement\r\n    danmakuList: DanmakuObj[] = []\r\n    setCanvasContainer(canvas: HTMLElement): boolean {\r\n        this.canvas = canvas\r\n        return true;\r\n    }\r\n    updateCanvasStyle(style: canvasStyle): boolean {\r\n        if (this.canvas) {\r\n            this.canvas.style.width = this.canvasSize.width.string();\r\n            this.canvas.style.height =this.canvasSize.height.string();\r\n            this.canvas.style.left = UnitTools.lengthSrting((style.size.width.length - this.canvasSize.width.length) / 2)\r\n            this.canvas.style.top = UnitTools.lengthSrting((style.size.height.length - this.canvasSize.height.length) / 2)\r\n            this.canvas.style.backgroundColor = style.color.string()\r\n            let r: number;//缩放大小\r\n            if (style.size.width.length / style.size.height.length >= this.canvasSize.width.length / this.canvasSize.height.length) {\r\n                //横向\r\n                r = style.size.height.length / this.canvasSize.height.length\r\n            } else {\r\n                //纵向\r\n                r = style.size.width.length / this.canvasSize.width.length\r\n            }\r\n            this.canvas.style.transform = \"scale(\" + r + \",\" + r + \")\"\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    addDanmaku(danmaku: DanmakuItemInterface): boolean {\r\n        if(!this.canvas) return false\r\n        let danmakuobj = DanmakuTool.recursionDanmaku([danmaku]) \r\n        let eles = DanmakuTool.recursionDiv(danmakuobj)\r\n        eles.forEach((ele) => {\r\n            this.canvas?.appendChild(ele)\r\n        })\r\n        this.danmakuList.push(...danmakuobj);\r\n        // console.log(this.danmakuList);\r\n        \r\n        return true;\r\n    }\r\n\r\n\r\n\r\n    refresh(time): boolean {\r\n        if (!this.canvas) {\r\n            return false;\r\n        }\r\n        \r\n        DanmakuTool.recursionStyle(this.danmakuList,this.canvas,time)\r\n        return true;\r\n    }\r\n    reset(): boolean {\r\n        //清空画布\r\n        \r\n        if(this.canvas){\r\n            this.canvas.innerHTML = \"\";\r\n        }\r\n        //清空数组\r\n        this.danmakuList = []\r\n        return true\r\n        \r\n    }\r\n}\r\n","/**\r\n * 简单渲染器工厂\r\n */\r\n\r\nimport { i18n } from \"src/ts/i18n\";\r\nimport { BaseRenderer } from \"src/ts/core/Renderer/BaseRenderer\";\r\nimport { RendererInterface } from \"src/ts/core/Renderer/RendererInterface\";\r\nimport { CSS3Renderer } from \"../core/Renderer/CSS3Renderer/CSS3Renderer\";\r\n\r\nexport class RendererFactory{\r\n    static rendererList = {\r\n        base:BaseRenderer,\r\n        css3:CSS3Renderer\r\n    }\r\n    static getRenderInstance(type:string):RendererInterface{\r\n        if (this.rendererList[type]) {\r\n            return new this.rendererList[type]()\r\n        }else{\r\n            throw ReferenceError(i18n.t(\"Renderer type is null\"))\r\n        }\r\n    }\r\n}","import { DanmakuItemInterface } from \"../core/Danmaku/DanmakuItemInterface\";\r\nimport { TimeLineDanmaku } from \"./TimeLineDanmaku\";\r\nimport { TimeLineInterface } from \"./TimeLineInterface\";\r\n\r\nexport class AdvancedLine implements TimeLineInterface {\r\n  \r\n\r\n    /**\r\n     * 上次获取时间(10ms)\r\n     */\r\n    lastTime: number = 0\r\n    /**\r\n     * 时间轴,二维数组，一维是弹幕的开始10毫秒数，二维是此毫秒数下的弹幕集合\r\n     * 注意：为了节省性能，最小单位时间是10ms，\r\n     *       仅仅是数组下标是10ms，其余的都是按照ms计算的\r\n     */\r\n    danmakuList: TimeLineDanmaku[][] = [];\r\n\r\n    /**\r\n     * 添加一个弹幕\r\n     * @param danmaku \r\n     * @param start\r\n     * @param end\r\n     */\r\n    addDanmaku(danmaku: DanmakuItemInterface, start?: number, end?: number) {\r\n\r\n        start = start || danmaku.startTime()\r\n\r\n        end = end || danmaku.getAnimation().getDuration() + start\r\n        let index = this.timeToIndex(start);\r\n\r\n        if(!this.danmakuList[index]){\r\n            this.danmakuList[index] = []\r\n        }\r\n        this.danmakuList[index].push({\r\n            danmaku: danmaku,\r\n            start: start,\r\n            end:end\r\n        })\r\n    }\r\n    /**\r\n     * 时间转换\r\n     * @param time \r\n     * @returns \r\n     */\r\n    protected timeToIndex(time: number): number {\r\n        return Math.floor(time / 10)\r\n    }\r\n    getDanmakuList(time: number):{skip:boolean;DanmakuList:TimeLineDanmaku[]}  {\r\n        time = this.timeToIndex(time);\r\n        //如果请求的时间超过了时间轴。。。\r\n        if (time < 0) {\r\n            return {skip:false,DanmakuList:[]};\r\n        }\r\n\r\n        let arr: TimeLineDanmaku[] = [];\r\n        let skip = false;\r\n        if (this.lastTime <= time && time - this.lastTime < 5) {\r\n            //正常播放情况,遍历期间的所有内容\r\n            // console.log(this.lastTime);\r\n            \r\n            for (let a = this.lastTime; a < time; a++) {\r\n                \r\n                if (this.danmakuList[a]) {\r\n                    // console.log(time);\r\n                    \r\n                    arr.push(...this.danmakuList[a])\r\n                }\r\n            }\r\n\r\n        } else {\r\n            //否则说明播放发生了跳转，则遍历找到合适的内容\r\n            //查找范围：在当前时间之前开始的，并且结束于当前时间之后的，\r\n            //先找到之前开始的\r\n            // console.log(time);\r\n            for (let timeIndex = 0; timeIndex < time; timeIndex++) {\r\n                if (!this.danmakuList[timeIndex]) {\r\n                    continue;//当前时间不存在\r\n                }\r\n                //接着再查找当前时间之后结束的\r\n                for (let l = 0; l < this.danmakuList.length; l++) {\r\n                    if (this.danmakuList[timeIndex][l]\r\n                        &&\r\n                        this.timeToIndex(this.danmakuList[timeIndex][l].end)\r\n                        > time) {\r\n                        arr.push(this.danmakuList[timeIndex][l])\r\n                    }\r\n                }\r\n            }\r\n            skip = true;\r\n\r\n        }\r\n        this.lastTime = time\r\n        return {skip:skip,DanmakuList:arr};\r\n    }\r\n    reset(): boolean {\r\n        this.danmakuList = []\r\n        return true\r\n    }\r\n}\r\n\r\n","import { AdvancedLine } from \"../TimeLine/AdvancedLine\";\r\nimport { TimeLineInterface } from \"../TimeLine/TimeLineInterface\";\r\n\r\nexport class TimeLineFactory{\r\n    static list = {\r\n        \"defult\":AdvancedLine,\r\n        \"advance\":AdvancedLine\r\n    }\r\n    static getTimeLine(type:string):TimeLineInterface{\r\n        if(!this.list[type]){\r\n           type = \"default\"\r\n        }\r\n        return new this.list[type]()\r\n    }\r\n}","/**\r\n * 对象深度合并\r\n * @param obj1 \r\n * @param obj2 \r\n * @returns \r\n */\r\nexport function deepMerge(obj1, obj2) {\r\n    let key;\r\n    for (key in obj2) {\r\n      // 如果target(也就是obj1[key])存在，且是对象的话再去调用deepMerge，否则就是obj1[key]里面没这个对象，需要与obj2[key]合并\r\n      // 如果obj2[key]没有值或者值不是对象，此时直接替换obj1[key]\r\n      obj1[key] =\r\n        obj1[key] &&\r\n        obj1[key].toString() === \"[object Object]\" &&\r\n        (obj2[key] && obj2[key].toString() === \"[object Object]\")\r\n          ? deepMerge(obj1[key], obj2[key])\r\n          : (obj1[key] = obj2[key]);\r\n    }\r\n    return obj1;\r\n  }","/**\r\n * 贝塞尔相关工具函数\r\n */\r\nexport class Cubic {\r\n    px3: number\r\n    px2: number\r\n    px1: number\r\n    py3: number\r\n    py2: number\r\n    py1: number\r\n    epsilon: number\r\n    constructor (a: number, b: number, c: number, d: number) {\r\n      this.px3 = 3 * a\r\n      this.px2 = 3 * (c - a) - this.px3\r\n      this.px1 = 1 - this.px3 - this.px2\r\n      this.py3 = 3 * b\r\n      this.py2 = 3 * (d - b) - this.py3\r\n      this.py1 = 1 - this.py3 - this.py2\r\n      this.epsilon = 1e-7      // 目标精度\r\n    }\r\n  \r\n    getX(t: number) {\r\n      return ((this.px1 * t + this.px2) * t + this.px3) * t\r\n    }\r\n  \r\n    getY(t: number) {\r\n      return ((this.py1 * t + this.py2) * t + this.py3) * t    \r\n    }\r\n  \r\n    solve(x: number) {\r\n      if (x === 0 || x === 1) {             // 对 0 和 1 两个特殊 t 不做计算\r\n        return this.getY(x)\r\n      } \r\n      let t = x\r\n      for (let i = 0; i < 8; i++) {         // 进行 8 次迭代\r\n        let g = this.getX(t) - x\r\n        if (Math.abs(g) < this.epsilon) {   // 检测误差到可以接受的范围\r\n          return this.getY(t)\r\n        }\r\n        let d = (3 * this.px1 * t + 2 * this.px2) * t + this.px3   // 对 x 求导\r\n        if (Math.abs(d) < 1e-6) {           // 如果梯度过低，说明牛顿迭代法无法达到更高精度\r\n          break\r\n        }\r\n        t = t - g / d\r\n      }\r\n      return this.getY(t)                   // 对得到的近似 t 求 y\r\n    }\r\n  }\r\n  ","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"./AnimationInterface\";\r\nimport { Cubic } from \"./Cubic\";\r\n\r\n/**\r\n * 贝塞尔动画类\r\n */\r\nexport abstract class CubicAnimations implements AnimationInterface {\r\n\r\n    /**\r\n     * 贝塞尔函数\r\n     */\r\n    cubicFunc: Cubic;\r\n    /**\r\n     * 贝塞尔参数\r\n     */\r\n    cubic: [number, number, number, number] = [0, 0, 1, 1]\r\n    /**\r\n     * 动画总时间\r\n     */\r\n    duration: number = 1000\r\n    //currentTime:number = 0\r\n    getMatrix(time: number): false | number[] {\r\n        if (this.isEnd(time)) return false\r\n        let p = this.getProgress(time)\r\n        let a = this.getMatrixForCubic(p, this.duration * p)\r\n        return a\r\n    }\r\n    getStyle(time: number): false | DanmakuStyle {\r\n        if (this.isEnd(time)) return false\r\n        let p = this.getProgress(time)\r\n        return this.getCubicStyle(p, this.duration * p)\r\n    }\r\n    setParams(param?: { [idx: string]: any; }): boolean {  \r\n        this.cubic = param?.cubic ? param?.cubic : this.cubic\r\n        this.duration = param?.duration ? param?.duration : this.duration\r\n        return true\r\n    }\r\n    getDuration(): number {\r\n        \r\n        return this.duration;\r\n    }\r\n    /**\r\n     * 根据动画时间获取动画进度\r\n     * @param time 动画时间\r\n     * @returns \r\n     */\r\n    getProgress(time: number): number {\r\n        //计算当前动画进度\r\n        let progress: number = time / this.duration\r\n        //计算出实际动画进度\r\n        let a = this.getCubic().solve(progress)\r\n        return a;\r\n    }\r\n    /**\r\n     * 根据进度返回区间内的值\r\n     * @param start \r\n     * @param end \r\n     * @param progress \r\n     */\r\n    getProgressValue(start: number, end: number, progress: number): number {\r\n        return start + (end - start) * progress\r\n    }\r\n    /**\r\n     * 判断动画是否结束\r\n     */\r\n    protected isEnd(time: number) {\r\n        return time > this.duration\r\n    }\r\n    /**\r\n     * 获取贝塞尔函数\r\n     * @returns \r\n     */\r\n    getCubic(): Cubic {\r\n        if (!this.cubicFunc) {\r\n            this.cubicFunc = new Cubic(...this.cubic)\r\n        }\r\n        return this.cubicFunc;\r\n    }\r\n    /**\r\n     * 计算贝塞尔样式\r\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\r\n     * @param progress 动画进度，0-1 有可能会超过此范围\r\n     */\r\n    abstract getCubicStyle(progress: number, time: number): DanmakuStyle | false\r\n    /**\r\n     * 计算贝塞尔的矩阵\r\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\r\n     * @param progress 动画进度，0-1 有可能会超过此范围\r\n     * @\r\n     */\r\n    abstract getMatrixForCubic(progress: number, time: number): number[] | false\r\n\r\n}","/**\r\n * 矩阵变换相关工具函数\r\n */\r\nexport class Matrix {\r\n    /**\r\n     * 加法\r\n     * @param a \r\n     * @param b \r\n     */\r\n    static add(a: number[], b: number[]): number[] {\r\n        let c: number[] = []\r\n        for (let i = 0; i < a.length; i++) {\r\n            c[i] = a[i] + b[i]\r\n        }\r\n        return c\r\n    }\r\n    /**\r\n     * 减法\r\n     * @param a \r\n     * @param b \r\n     * @returns \r\n     */\r\n    static sub(a: number[], b: number[]): number[] {\r\n        let c: number[] = []\r\n        for (let i = 0; i < a.length; i++) {\r\n            c[i] = a[i] - b[i]\r\n        }\r\n        return c\r\n    }\r\n    static mult(a: number[], b: number[]): number[] {\r\n        let a1 = this.tran(a);\r\n        let b1 = this.tran(b);\r\n         // 相乘约束\r\n         if (a1[0].length !== b1.length) {\r\n            throw new Error();\r\n        }\r\n        let m = a1.length;\r\n        let p = a1[0].length;\r\n        let n = b1[0].length;\r\n    \r\n        // 初始化 m*n 全 0 二维数组\r\n        let c = new Array(m).fill(0).map(()=> new Array(n).fill(0));\r\n    \r\n        for (let i = 0; i < m; i++) {\r\n            for (let j = 0; j < n; j++) {\r\n                for (let k = 0; k < p; k++) {\r\n                    c[i][j] += a1[i][k] * b1[k][j];\r\n                }\r\n            }\r\n        }\r\n    \r\n        return [...c[0],...c[1],...c[2],...c[3]];\r\n    }\r\n    /**\r\n     * 将一维16位数组转换成4*4二维数组\r\n     * @param a \r\n     */\r\n     protected static tran(a: number[]):number[][] {\r\n        let arr: number[][] = []\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                let index = i * 4 + j\r\n                if(!arr[i]) arr[i] = [];\r\n                arr[i][j] = a[index];\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n    /**\r\n     * 获得一个无效果的4x4矩阵\r\n     */\r\n    static getNullMatrix():number[]{\r\n        return [\r\n            1,0,0,0,\r\n            0,1,0,0,\r\n            0,0,1,0,\r\n            0,0,0,1\r\n        ]\r\n    }\r\n}","\r\nimport { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\r\nimport { deepMerge } from \"src/ts/util/deepMerge\";\r\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\r\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\r\nimport { Matrix } from \"../Base/Matrix\";\r\n\r\n\r\n/**\r\n * 动画组，用于多个动画并行播放\r\n */\r\nexport class GroupAnimations extends CubicAnimations {\r\n    animations: AnimationInterface[] = []\r\n    /**\r\n     * 每个动画结束的累计矩阵\r\n     */\r\n     cumulativeMatrix: number[][] = []\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        super.setParams(param);\r\n        \r\n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])      \r\n        //计算出最大的动画时长\r\n        this.animations.forEach((val,key)=>{\r\n            let dur = val.getDuration()\r\n             //计算最后一帧\r\n            this.cumulativeMatrix[key] = val.getMatrix(dur) || Matrix.getNullMatrix();\r\n            if(dur > this.duration){\r\n               \r\n                //这里覆盖了父类的属性\r\n                //实际上，只有父类的时长不够，才会被更新\r\n                this.duration = val.getDuration();\r\n            }\r\n        })\r\n        \r\n        return true;\r\n    }\r\n    getCubicStyle(_progress: number,time:number): false | DanmakuStyle {\r\n        /**\r\n         * 合并样式，由于样式的特殊性，如果存在冲突的样式，后面的会覆盖前面的\r\n         */\r\n        let style:DanmakuStyle = {boxStyle:{},fontStyle:{}};\r\n        let noneStyle = true;\r\n        for(let i = 0;i<this.animations.length;i++){\r\n            let style2 = this.animations[i].getStyle(time)\r\n            if(style2){\r\n                noneStyle = false;\r\n                style = deepMerge(style,style2);\r\n            }\r\n           \r\n        }\r\n        if(noneStyle) return false;\r\n        return style;\r\n    }\r\n    getMatrixForCubic(_progress: number,time:number): false | number[] {\r\n        //建立一个空白矩阵\r\n        let arr:number[] = [\r\n            1,0,0,0,\r\n            0,1,0,0,\r\n            0,0,1,0,\r\n            0,0,0,1\r\n        ]\r\n        //倒着计算所有的矩阵\r\n        for(let i = this.animations.length - 1;i >= 0;i--){\r\n            let matrix = this.animations[i].getMatrix(time)\r\n            // console.log(matrix);\r\n            \r\n            if(matrix){\r\n                arr = Matrix.mult(arr,matrix);\r\n            }else{\r\n                arr = Matrix.mult(arr,this.cumulativeMatrix[i]);\r\n            }\r\n        }\r\n        \r\n        return arr;\r\n    }\r\n\r\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\r\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\r\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\r\nimport { Matrix } from \"../Base/Matrix\";\r\n/**\r\n * 动画列表组，所有动画按顺序播放\r\n */\r\nexport class ListAnimations extends CubicAnimations {\r\n    animations: AnimationInterface[] = []\r\n    /**\r\n     * 每个动画结束的累计矩阵\r\n     */\r\n    cumulativeMatrix: number[][] = []\r\n    cumulativeTime: number[] = []\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        super.setParams(param);\r\n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])\r\n\r\n        let duration = 0;\r\n        this.cumulativeMatrix[0] = Matrix.getNullMatrix();\r\n        this.cumulativeTime[0] = duration\r\n\r\n        this.animations.forEach((val, key) => {\r\n            let dur = val.getDuration()\r\n\r\n\r\n            //自增1，因为0的结束帧的1的开头\r\n            key++\r\n            //计算出每个动画结束后的矩阵叠加,传入持续时间以获得最后一帧动画\r\n            let matrix = val.getMatrix(dur) || Matrix.getNullMatrix();\r\n            //叠加\r\n            this.cumulativeMatrix[key] =\r\n                Matrix.mult(matrix, this.cumulativeMatrix[key - 1])\r\n\r\n            duration += dur;\r\n            this.cumulativeTime[key] = duration\r\n\r\n        })\r\n        \r\n        if (this.duration < duration) { this.duration = duration; }\r\n\r\n        return true;\r\n    }\r\n\r\n    getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\r\n        let curAnimation = this.getCurAnimation(time)\r\n\r\n        if (curAnimation) {\r\n            return curAnimation.animation.getStyle(time)\r\n        }\r\n        return false\r\n    }\r\n\r\n    getMatrixForCubic(_progress: number, time: number): false | number[] {\r\n\r\n\r\n        let curAnimation = this.getCurAnimation(time)\r\n\r\n        if (curAnimation) {\r\n\r\n            time = time - this.cumulativeTime[curAnimation.key]\r\n\r\n            let mat = curAnimation.animation.getMatrix(time) || Matrix.getNullMatrix()\r\n            return Matrix.mult(mat, this.cumulativeMatrix[curAnimation.key])\r\n        }\r\n        return false\r\n    }\r\n    /**\r\n     * 获取当前的动画元素,如果不存在则返回false\r\n     */\r\n    protected getCurAnimation(time: number): { key: number, animation: AnimationInterface } | false {\r\n\r\n        for (let i = this.animations.length - 1; i >= 0; i--) {\r\n            let duration = this.cumulativeTime[i]\r\n            if (time > duration) {\r\n                return { key: i, animation: this.animations[i] }\r\n            }\r\n        }\r\n        return false\r\n    }\r\n\r\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\r\n\r\n/**\r\n * 透明度动画\r\n *\r\n * @export\r\n * @class OpacityAnimations\r\n * @extends {CubicAnimations}\r\n */\r\nexport class OpacityAnimations extends CubicAnimations{\r\n    opacity:[number,number] = [0,1]\r\n    setParams(param?: { [idx: string]: any; }):boolean{\r\n        super.setParams(param);\r\n        this.opacity = param?.opacity || this.opacity\r\n        return true\r\n    }\r\n    getCubicStyle(progress: number, _time: number): false | DanmakuStyle {\r\n        return {\r\n            opacity:this.getProgressValue(this.opacity[0],this.opacity[1],progress)\r\n        }\r\n    }\r\n    getMatrixForCubic(_progress: number, _time: number): false | number[] {\r\n        return false\r\n    }\r\n\r\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\r\n\r\n/**\r\n * 静止动画 仅仅悬停在某一个位置一定时间\r\n */\r\nexport class StaticAnimation implements AnimationInterface {\r\n    getDuration(): number {\r\n        return this.duration;\r\n    }\r\n\r\n    duration: number = 1000;\r\n    x: number = 0;\r\n    y: number = 0;\r\n    z: number = 0;\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        let def = 0;\r\n        this.duration = param?.duration || this.duration\r\n        this.x = param?.x || def\r\n        this.y = param?.y || def\r\n        this.z = param?.z || def\r\n        return true\r\n    }\r\n    getMatrix(time: number): false | number[] {\r\n        // console.log(time);\r\n\r\n        if (time > this.duration) return false;\r\n\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            this.x, this.y, this.z, 1\r\n        ]\r\n\r\n    }\r\n    getStyle(): false | DanmakuStyle {\r\n        return false\r\n    }\r\n\r\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\r\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\r\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\r\nimport { StaticAnimation } from \"../TransformsAnimations/StaticAnimation\";\r\n\r\nexport class RepeatAnimations extends CubicAnimations{\r\n    /**\r\n     * 动画接口\r\n     */\r\n    animation:AnimationInterface\r\n    /**\r\n     * 重复次数\r\n     */\r\n    repeat:number = 1\r\n    /**\r\n     * 单个动画时间\r\n     */\r\n    animationTime:number\r\n    getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\r\n        return this.animation.getStyle(this.getCurTime(time))\r\n    }\r\n    getMatrixForCubic(_progress: number, time: number): false | number[] {\r\n        return this.animation.getMatrix(this.getCurTime(time))\r\n    }\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        super.setParams(param);\r\n        \r\n        if(param?.animation){\r\n            this.animation =  AnimationFactory.getAnimations(param?.animation.type,param?.animation.params) || new StaticAnimation()\r\n           \r\n        }else{\r\n            this.animation = new StaticAnimation()\r\n        }\r\n        \r\n        console.log(this.animation);\r\n        \r\n        this.repeat = param?.repeat || this.repeat\r\n        this.animationTime = this.animation.getDuration()\r\n        //覆盖父级存活时间 \r\n        //计算方式 单个弹幕时间 X 弹幕重复次数\r\n        this.duration = this.animationTime * this.repeat\r\n        console.log(this.duration);\r\n        \r\n        return true\r\n    }\r\n    /**\r\n     * 获得当前的弹幕时间\r\n     */\r\n    getCurTime(time:number){\r\n        //取余\r\n        return time % this.animationTime\r\n    }\r\n}","import { CubicAnimations } from \"./CubicAnimations\";\r\nimport { Matrix } from \"./Matrix\";\r\n\r\n/**\r\n * 可改变动画中心点的动画\r\n *\r\n * @export\r\n * @abstract\r\n * @class OriginAnimations\r\n * @extends {CubicAnimations}\r\n */\r\nexport abstract class OriginAnimations extends CubicAnimations {\r\n    origin:number[] = [0,0,0]\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        if (!super.setParams(param)) return false;\r\n        this.origin =  param?.origin || this.origin\r\n        return true\r\n    }\r\n    getMatrixForCubic(progress: number): number[] | false{\r\n        let arr = this.getMatrixForOrigin(progress)\r\n        if(!arr) return false\r\n        arr = Matrix.mult([\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            -this.origin[0], -this.origin[1], -this.origin[2], 1\r\n\r\n        ],arr)\r\n        return Matrix.mult(arr,[\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            this.origin[0], this.origin[1], this.origin[2], 1\r\n\r\n        ])\r\n    }\r\n    /**\r\n     * 获取用于计算原坐标点的矩阵\r\n     * @param progress \r\n     */\r\n    abstract getMatrixForOrigin(progress: number): number[] | false\r\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\r\n\r\n/**\r\n * 缩放动画\r\n */\r\nexport class ScaleAnimations extends OriginAnimations{\r\n    scale:{x1:number,y1:number,z1:number,x2:number,y2:number,z2:number} \r\n    = {x1:1,y1:1,z1:1,x2:1,y2:1,z2:1}\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        if (!super.setParams(param)) return false;\r\n        this.scale = Object.assign(this.scale,param?.scale)\r\n        return true\r\n    }\r\n    getMatrixForOrigin(progress: number): false | number[] {\r\n        let x = this.getProgressValue(this.scale.x1, this.scale.x2, progress);\r\n        let y = this.getProgressValue(this.scale.y1, this.scale.y2, progress)\r\n        let z = this.getProgressValue(this.scale.z1, this.scale.z2, progress)\r\n        let m = [\r\n            x,0,0,0,\r\n            0,y,0,0,\r\n            0,0,z,0,\r\n            0,0,0,1\r\n        ]\r\n        return m\r\n\r\n    }\r\n    getCubicStyle(_progress: number): false | DanmakuStyle {\r\n       return false\r\n    }\r\n\r\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\r\n\r\nexport class TranslateAnimation extends CubicAnimations {\r\n\r\n    path: { x1: number, y1: number, z1: number, x2: number, y2: number, z2: number }\r\n        =\r\n        { x1: 0, y1: 0, x2: 0, y2: 0, z1: 0, z2: 0 }\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        if (!super.setParams(param)) return false;\r\n        this.path = Object.assign(this.path,param?.path)\r\n        return true\r\n    }\r\n    getCubicStyle(): false | DanmakuStyle {\r\n        return false;\r\n    }\r\n    getMatrixForCubic(progress: number): false | number[] {\r\n        // console.log(this.path);\r\n        // console.log(progress);\r\n\r\n        let x = this.getProgressValue(this.path.x1, this.path.x2, progress);\r\n        let y = this.getProgressValue(this.path.y1, this.path.y2, progress)\r\n        let z = this.getProgressValue(this.path.z1, this.path.z2, progress)\r\n\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            x, y, z, 1\r\n        ]\r\n    }\r\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\r\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\r\n\r\n/**\r\n * 旋转父类\r\n */\r\nexport abstract class RotationAnimation extends OriginAnimations {\r\n\r\n    angle:{start:number,end:number} = {start:0,end:360}\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        if (!super.setParams(param)) return false;\r\n        this.angle = Object.assign(this.angle,param?.angle)\r\n        return true\r\n    }\r\n    getCubicStyle(_progress: number): false | DanmakuStyle {\r\n        return false;\r\n    }\r\n    /**\r\n     * 角度转弧度\r\n     */\r\n    protected A2R(a: number) {\r\n        return a * (Math.PI / 180)\r\n    }\r\n}","import { RotationAnimation } from \"./RotationAnimation\";\r\n\r\n/**\r\n * X轴旋转\r\n */\r\nexport class RotationXAnimation extends RotationAnimation {\r\n    getMatrixForOrigin(progress: number): false | number[] {\r\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\r\n        let sin = Math.sin(this.A2R(angle));\r\n        let cos = Math.cos(this.A2R(angle))\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, cos, sin, 0,\r\n            0, -sin, cos, 0,\r\n            0, 0, 0, 1\r\n        ]\r\n    }\r\n}","import { RotationAnimation } from \"./RotationAnimation\";\r\n/**\r\n * y轴旋转\r\n */\r\nexport class RotationYAnimation extends RotationAnimation {\r\n    getMatrixForOrigin(progress: number): false | number[] {\r\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\r\n        let sin = Math.sin(this.A2R(angle));\r\n        let cos = Math.cos(this.A2R(angle))\r\n        return [\r\n            cos, 0, sin, 0,\r\n            0, 1, 0, 0,\r\n            -sin, 0, cos, 0,\r\n            0, 0, 0, 1\r\n        ]\r\n    }\r\n}","import { RotationAnimation } from \"./RotationAnimation\";\r\n\r\n/**\r\n * z轴旋转\r\n */\r\nexport class RotationZAnimation extends RotationAnimation {\r\n    getMatrixForOrigin(progress: number): false | number[] {\r\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\r\n        let sin = Math.sin(this.A2R(angle));\r\n        let cos = Math.cos(this.A2R(angle))\r\n        return [\r\n            cos,sin, 0, 0,\r\n            -sin, cos, 0, 0,\r\n            0, 0,1, 0,\r\n            0, 0, 0, 1\r\n        ]\r\n    }\r\n}","import { AnimationInterface } from \"../core/Animation/Base/AnimationInterface\";\r\nimport { GroupAnimations } from \"../core/Animation/CompositeAnimation/GroupAnimations\";\r\nimport { ListAnimations } from \"../core/Animation/CompositeAnimation/ListAnimations\";\r\nimport { OpacityAnimations } from \"../core/Animation/styleAnimations/OpacityAnimations\";\r\nimport { RepeatAnimations } from \"../core/Animation/CompositeAnimation/RepeatAnimations\";\r\nimport { ScaleAnimations } from \"../core/Animation/TransformsAnimations/ScaleAnimations\";\r\nimport { TranslateAnimation } from \"../core/Animation/TransformsAnimations/TranslateAnimation\";\r\nimport { RotationXAnimation } from \"../core/Animation/TransformsAnimations/RotationXAnimation\";\r\nimport { RotationYAnimation } from \"../core/Animation/TransformsAnimations/RotationYAnimation\";\r\nimport { RotationZAnimation } from \"../core/Animation/TransformsAnimations/RotationZAnimation\";\r\nimport { StaticAnimation } from \"../core/Animation/TransformsAnimations/StaticAnimation\";\r\n\r\nexport class AnimationFactory {\r\n    static animationList = {\r\n        \"static\":StaticAnimation,//静态定位\r\n        \"translate\":TranslateAnimation,//平移\r\n        \"rotateX\":RotationXAnimation,// x轴旋转\r\n        \"rotateY\":RotationYAnimation,//y轴旋转\r\n        \"rotateZ\":RotationZAnimation,//z轴旋转\r\n        \"scale\":ScaleAnimations,//缩放\r\n        \"list\":ListAnimations,//动画列表\r\n        \"group\":GroupAnimations,//动画组\r\n        \"repeat\":RepeatAnimations,//重复动画\r\n        \"opacity\":OpacityAnimations\r\n    }\r\n\r\n    static getAnimations(type:string,params):AnimationInterface | false{\r\n        if(this.animationList[type]){\r\n            // console.log(params);\r\n            let ani = new this.animationList[type]()\r\n            // console.log(ani);\r\n            \r\n            ani.setParams(params)\r\n            return ani;\r\n        }\r\n        return false;\r\n    }\r\n    static getAnimationsList(list:{key: { [idx: string]: any; }}[]):AnimationInterface[]{\r\n        let animationList:AnimationInterface[] = []\r\n        \r\n        list?.forEach((val)=>{\r\n            let ani =  this.getAnimations(val[\"type\"],val)\r\n            if(ani){\r\n                animationList.push(ani);\r\n            }\r\n        })\r\n        return animationList\r\n    }\r\n}","import { DanmakuStyle } from \"../Style/DanmakuStyle\";\r\nimport { AnimationInterface } from \"../Animation/Base/AnimationInterface\";\r\nimport { DanmakuItemInterface } from \"./DanmakuItemInterface\";\r\nimport { StaticAnimation } from \"../Animation/TransformsAnimations/StaticAnimation\";\r\n\r\n/**\r\n * 基础弹幕类型\r\n */\r\nexport class BaseDanmaku implements DanmakuItemInterface {\r\n\r\n\r\n    style:DanmakuStyle = {}\r\n    start:number = 0;\r\n    animation?:AnimationInterface\r\n    content:string = \"\"\r\n    child:DanmakuItemInterface[] = []\r\n    /**\r\n     * 设置参数\r\n     * @param param \r\n     * @returns \r\n     */\r\n    setParams(param: { [idx: string]: any; }): boolean {\r\n        //设置文字样式\r\n        try{\r\n            //设置开始时间\r\n            param?.start &&　(this.start = param?.start)\r\n            param?.animation && (this.animation =  param?.animation ||  new StaticAnimation())\r\n            param?.child && (this.child = param.child)\r\n            param?.style && (this.style = param?.style)\r\n            param?.content && (this.content = param?.content)\r\n\r\n            \r\n        }catch(e){\r\n            console.warn(e);\r\n            return false;\r\n        }\r\n       \r\n        return true\r\n    }\r\n    getType(): string {\r\n        return \"base\"\r\n    }\r\n    getContent(): string {\r\n        return this.content\r\n    }\r\n    getChild(): DanmakuItemInterface[] {\r\n        return this.child\r\n    }\r\n    getAnimation(): AnimationInterface {\r\n        if(!this.animation){\r\n            this.animation = new StaticAnimation()\r\n        }\r\n        return this.animation\r\n    }\r\n    getStyle(): DanmakuStyle {\r\n        return this.style\r\n    }\r\n    startTime(): number {\r\n        return this.start\r\n    }\r\n}\r\n\r\n","import { BaseDanmaku } from \"src/ts/core/Danmaku/BaseDanmaku\";\r\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\r\n\r\nexport class DanmakuFactory{\r\n    static list = {\r\n        \"text\":BaseDanmaku\r\n    }\r\n    static getDanmakuInstance(type:string):DanmakuItemInterface{\r\n        if(!this.list[type]){\r\n            type = \"text\"\r\n        }\r\n        return new this.list[type]()\r\n    }\r\n}","import { i18n } from \"src/ts/i18n\";\r\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\r\nimport { AnimationFactory } from \"../AnimationFactory\";\r\nimport { DanmakuFactory } from \"./DanmakuFactory\";\r\nimport { DanmakuParserInterface } from \"./DanmakuParserInterface\";\r\n\r\nexport class JsonDanmakuParser implements DanmakuParserInterface {\r\n\r\n    parser(content: string): DanmakuItemInterface[] {\r\n        try {\r\n            let json: any[] = JSON.parse(content)\r\n            \r\n            return this.getDanmaku(json);\r\n        } catch (e) {\r\n            console.warn(i18n.t(\"Danmaku parser fail\"))\r\n            console.warn(e);\r\n            return []\r\n        }\r\n\r\n    }\r\n\r\n    getDanmaku(obj?: any[]):DanmakuItemInterface[] {\r\n        let list:DanmakuItemInterface[] = []\r\n\r\n        obj?.forEach((dan) => {\r\n            \r\n            let danmaku = DanmakuFactory.getDanmakuInstance(dan.type)\r\n            if(!dan?.animations || dan?.animations === []){\r\n                dan.animations = [{type:\"static\"}]\r\n            } \r\n            danmaku.setParams({\r\n                start: dan?.start,\r\n                content:dan?.content,\r\n                style:dan?.style,\r\n                animation: AnimationFactory.getAnimations(\"list\",{animations:dan?.animations}),//将列表组成一个list\r\n                child:this.getDanmaku(dan.childs)\r\n            })\r\n\r\n            list.push(danmaku);\r\n        })\r\n        return list;\r\n\r\n    }\r\n}","\r\nimport { SizeInterface } from \"../core/Style/SizeInterface\";\r\nimport { StageInterface } from \"../core/Stage/StageInterface\";\r\nimport { Context } from \"../Context/Context\";\r\nimport { i18n } from \"../i18n\";\r\nimport { canvasStyle } from \"../core/Style/CanvasStyle\";\r\nimport { RendererFactory } from \"src/ts/Factory/RendererFactory\";\r\nimport { PxSize } from \"../core/Style/Unit/PxSize\";\r\nimport { TimeLineFactory } from \"../Factory/TimeLineFactort\";\r\nimport { JsonDanmakuParser } from \"../Factory/DanmakuParser/JsonDanmakuParser\";\r\n\r\n/**\r\n * 控制器 ，统一管理整个弹幕系统\r\n * 在这里，每种弹幕类型都会得到一个舞台对象，进行渲染\r\n */\r\nexport class Controller {\r\n    /**\r\n     * 画布对象\r\n     */\r\n    protected containers: HTMLElement;\r\n    /**\r\n     * 实时的Css样式表\r\n     */\r\n    protected canvasStyle: CSSStyleDeclaration;\r\n    /**\r\n     * 舞台列表\r\n    */\r\n    protected stageList: StageInterface[] = [];\r\n    /**\r\n     * 暂停状态\r\n     */\r\n    protected pauseStatus: boolean = true;\r\n    /**\r\n     * 时间戳\r\n     */\r\n    protected timeStamp: number = 0;\r\n    /**\r\n     * 播放的时间\r\n     */\r\n    protected time: number = 0;\r\n    /**\r\n     * 跳转状态\r\n     */\r\n    skipStatus: boolean = false;\r\n\r\n    protected danmakuFunction: { [type: string]: (send: (str: string[]) => void) => void } = {}\r\n    constructor(containers: HTMLElement) {\r\n        this.containers = containers\r\n        //获取实时的style对象，当大小发生变化时，会更新自身\r\n        this.canvasStyle = window.getComputedStyle(containers);\r\n        //初始化容器\r\n        this.initContainer()\r\n        let that = this;\r\n        (function animloop() {\r\n\r\n            if (!that.pauseStatus) {\r\n                that.refresh()\r\n            }\r\n            requestAnimationFrame(animloop);\r\n\r\n\r\n        })()\r\n    }\r\n    /**\r\n     * 获得容器尺寸\r\n     */\r\n    public getContainersSize(): SizeInterface {\r\n        return {\r\n            width: new PxSize(parseInt(this.canvasStyle.width)),\r\n            height: new PxSize(parseInt(this.canvasStyle.height))\r\n        }\r\n    }\r\n    /**\r\n     * 将一个舞台添加到容器内\r\n     * @param stage 舞台\r\n     * @param index 排列顺序\r\n     * @returns 成功与失败的状态\r\n     */\r\n    public registStage(stage: StageInterface, index: number): boolean {\r\n        //检查列表中是否存在\r\n        if (this.stageList[index]) {\r\n            return false;\r\n        }\r\n        this.stageList[index] = stage;\r\n        return true;\r\n    }\r\n    /**\r\n     * 将舞台挂载到容器中\r\n     */\r\n    public mount() {\r\n        console.info(i18n.t(\"Start mount stage\"));\r\n        //遍历每一个舞台\r\n        this.stageList.forEach((stage,key) => {\r\n            //获取一个div\r\n            let div = this.getDIV()\r\n            //给舞台初始化渲染器\r\n            let render = RendererFactory.getRenderInstance(stage.rendererType());\r\n            //将div挂载到渲染器\r\n            render.setCanvasContainer(div)\r\n            //设置舞台渲染器\r\n            stage.stageRenderer(render);\r\n            //设置舞台时间轴\r\n            let lineType = stage.timeLineType()\r\n            let timeline = TimeLineFactory.getTimeLine(lineType)\r\n            stage.timeLine(timeline)\r\n            //检察是否存在弹幕获取器\r\n            if (this.danmakuFunction[lineType]) {\r\n                //如果存在，就获取弹幕\r\n                    this.resetDanmaku(key)\r\n            } else {\r\n                console.warn(i18n.t(\"danmaku get function is null :\" + lineType));\r\n            }\r\n            \r\n            //更新渲染器内画布样式\r\n            render.updateCanvasStyle(this.getCanvasStylByStage(stage))\r\n        })\r\n       \r\n    }\r\n\r\n    /**\r\n     * 初始化弹幕容器\r\n     */\r\n    protected initContainer() {\r\n        if (Context.debug) {\r\n            //debug模式\r\n            this.containers.classList.add(\"danmaku-containers-debug\")\r\n        }\r\n        this.containers.classList.add(\"danmaku-containers\")\r\n\r\n    }\r\n\r\n    /**\r\n     * 重置尺寸\r\n     */\r\n    public resize() {\r\n        //重置舞台的尺寸\r\n        this.stageList.forEach((stage) => {\r\n            let render = stage.getRenderer()\r\n            if (render) {\r\n                render.updateCanvasStyle(this.getCanvasStylByStage(stage));\r\n            }\r\n        })\r\n    }\r\n    /**\r\n     * 创建div容器 \r\n     */\r\n    protected getDIV(): HTMLElement {\r\n        let div = document.createElement(\"div\");\r\n        div.classList.add(\"stage\")\r\n        this.containers.appendChild(div);\r\n        return div;\r\n    }\r\n\r\n    /**\r\n     * 根据舞台对象创建一个canvasStyle\r\n     * @param stage 舞台对象\r\n     * @returns \r\n     */\r\n    protected getCanvasStylByStage(stage: StageInterface): canvasStyle {\r\n        let size = stage.stageSize(this.getContainersSize())\r\n        let color = stage.stageBackgroundColor(this.getContainersSize())\r\n        let pos = stage.stagePosition(this.getContainersSize(), size)\r\n        return { position: pos, color: color, size: size }\r\n    }\r\n\r\n    refresh() {\r\n\r\n        this.time = Date.now() - this.timeStamp\r\n        //通知每个舞台刷新\r\n        this.stageList.forEach((stage) => {\r\n            // console.log(1)\r\n            stage.refresh(this.time)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 暂停\r\n     */\r\n    pause() {\r\n        if (!this.pauseStatus) {\r\n            this.pauseStatus = true;\r\n        }\r\n    }\r\n    /**\r\n     * 播放\r\n     */\r\n    start() {\r\n        if (this.pauseStatus) {\r\n            //同步时间\r\n            this.timeStamp = Date.now() - this.time;\r\n            this.pauseStatus = false;\r\n        }\r\n    }\r\n    /**\r\n     * 跳转\r\n     */\r\n    skip(time: number) {\r\n        if (this.pauseStatus) {\r\n            //如果是暂停状态\r\n            this.time = time;\r\n        } else {\r\n            //否则使用这个方法\r\n            this.timeStamp = Date.now() - time\r\n        }\r\n    }\r\n    /**\r\n     * 重置整个系统\r\n     */\r\n    reset() {\r\n        //清空所有舞台\r\n        this.stageList.forEach((stage) => {\r\n            stage.reset()\r\n        })\r\n        this.pauseStatus = true\r\n        this.timeStamp = 0\r\n        this.time = 0\r\n        this.skipStatus = false\r\n    }\r\n    getTime() {\r\n        return this.time\r\n    }\r\n    addGetDanmakuFunction(type: string, fun: (send: (str: string[]) => void) => void) {\r\n        this.danmakuFunction[type] = fun\r\n    }\r\n    resetDanmaku(type:number){\r\n        if(this.stageList[type]){\r\n            let stage = this.stageList[type]\r\n            stage.getTimeLine().reset();\r\n            let lineType = stage.timeLineType();\r\n            let fun = this.danmakuFunction[lineType]\r\n            if(!!fun){\r\n                fun((res:string[])=>{\r\n                    let parser = new JsonDanmakuParser();\r\n                    let timeline = stage.getTimeLine()\r\n                    res.forEach((danmakuStr:string)=>{\r\n                        parser.parser(danmakuStr).forEach((danmaku) => {\r\n                            timeline.addDanmaku(danmaku)\r\n                        });\r\n                    })\r\n                })\r\n            }\r\n        }\r\n    }\r\n}","import { UnitInterface } from \"./UnitInterface\"\r\n\r\n/**\r\n * 颜色接口\r\n */\r\n\r\nexport class Color implements UnitInterface {\r\n    r: number\r\n    g: number\r\n    b: number\r\n    a: number\r\n    constructor(r:number, g:number, b:number, a:number) {\r\n        this.r = r\r\n        this.g = g\r\n        this.b = b\r\n        this.a = a\r\n    }\r\n    string(): string {\r\n        return \"rgba(\" + this.r + \",\" + this.g + \",\" + this.b + \",\" + this.a + \")\"\r\n    }\r\n    /**\r\n     * 常见颜色表\r\n     */\r\n    protected static color:{[key:string]:[number,number,number,number]} = {\r\n        \"black\":[0,0,0,1],\r\n        \"white\":[255,255,255,1],\r\n        \"red\":[255,0,0,1],\r\n        \"green\":[0,255,0,1],\r\n        \"blue\":[0,0,255,1],\r\n        \"pink\":[255,105,108,1],\r\n        \"yellow\":[255,255,0,1],\r\n        \"grey\":[130,130,130,1]\r\n    }\r\n    /**\r\n     * 获取预设颜色\r\n     * @param color 颜色名称\r\n     * @returns \r\n     */\r\n    static getColor(color:string):Color{\r\n        if(this.color[color]){\r\n            return new this(...this.color[color])\r\n        }else{\r\n            return new this(...this.color[\"black\"])\r\n        }\r\n        \r\n    }\r\n}","import { RendererInterface } from \"../Renderer/RendererInterface\";\r\nimport { Color } from \"../Style/Unit/Color\";\r\nimport { PositionInterface } from \"../Style/PositionInterface\";\r\nimport { SizeInterface } from \"../Style/SizeInterface\";\r\nimport { StageInterface } from \"./StageInterface\";\r\nimport { PxSize } from \"../Style/Unit/PxSize\";\r\nimport { TimeLineInterface } from \"src/ts/TimeLine/TimeLineInterface\";\r\nimport { i18n } from \"src/ts/i18n\";\r\nimport { TimeLineDanmaku } from \"src/ts/TimeLine/TimeLineDanmaku\";\r\n\r\nexport abstract class BaseStage implements StageInterface {\r\n\r\n\r\n    protected renderer?: RendererInterface;\r\n    protected timeLineObj?: TimeLineInterface\r\n    stageSize(containersSize: SizeInterface): SizeInterface {\r\n        return {\r\n            width: containersSize.width,\r\n            height: containersSize.height\r\n        }\r\n    }\r\n    stagePosition(): PositionInterface {\r\n        return {\r\n            x:new PxSize(0),\r\n            y:new PxSize(0)\r\n        }\r\n    }\r\n    stageBackgroundColor(): Color {\r\n        return  new Color(0,0,0,0);\r\n    }\r\n    stageRenderer(render: RendererInterface): boolean {\r\n        this.renderer = render\r\n        return true;\r\n    }\r\n    getRenderer(): RendererInterface {\r\n        if(this.renderer){\r\n            return this.renderer\r\n        }else{\r\n            throw ReferenceError(i18n.t(\"renderer is null\"))\r\n        }\r\n        \r\n    }\r\n    timeLine(timeLine: TimeLineInterface): boolean {\r\n        this.timeLineObj = timeLine;\r\n        return true;\r\n    }\r\n    refresh(time:number):boolean{\r\n        if(!this.renderer) return false;\r\n        let list:{ skip: boolean; DanmakuList: TimeLineDanmaku[]; }\r\n        if(list = this.timeLineObj?.getDanmakuList(time) || {skip:false,DanmakuList:[]}){\r\n            if(list.skip){\r\n                // console.log(list.skip);\r\n\r\n                \r\n                this.renderer?.reset()\r\n            }\r\n            \r\n            list.DanmakuList.forEach((val)=>{ \r\n                this.renderer?.addDanmaku(val.danmaku)\r\n            })\r\n        }\r\n        this.renderer.refresh(time)\r\n        return true\r\n    }\r\n    rendererType(): string {\r\n        return \"css3\"\r\n    }\r\n    timeLineType(): string {\r\n        return \"advance\"\r\n    }\r\n\r\n    reset(): boolean {\r\n        this?.renderer?.reset()\r\n        return true\r\n    \r\n    }\r\n    getTimeLine(): TimeLineInterface {\r\n        if(!this.timeLineObj){\r\n            throw ReferenceError(i18n.t(\"Time line is null\"));\r\n        }\r\n        return this.timeLineObj\r\n    }\r\n   \r\n}","\r\nimport { BaseStage } from \"./BaseStage\";\r\n\r\n\r\nexport class TestStage extends BaseStage{\r\n\r\n}","import \"../css/base.css\";\r\nimport { Controller } from './Controller/Controller';\r\nimport { i18n } from \"./i18n\"\r\nimport { InitConfigInterface } from \"./core/InitConfigInterface\";\r\nimport { TestStage } from \"./core/Stage/TestStage\";\r\nexport class MfunsDanMaku {\r\n\r\n    controller:Controller; \r\n    constructor(config: InitConfigInterface) {\r\n        //类型检查\r\n        if (!config.containers) {\r\n            throw ReferenceError(i18n.t(\"Containers is null\"))\r\n        }\r\n        this.controller = new Controller(config.containers)\r\n        this.controller.addGetDanmakuFunction(\"advance\",config.danmaku)\r\n        this.controller.registStage(new TestStage(), 1)\r\n        this.controller.mount()\r\n        //监听大小变化\r\n        window.addEventListener(\"resize\", () => {\r\n            this.controller.resize()\r\n        })\r\n    }\r\n    pause(){\r\n        this.controller.pause()\r\n    }\r\n    start(){\r\n        this.controller.start()\r\n    }\r\n    skip(time:number){\r\n        this.controller.skip(time)\r\n    }\r\n    time(){\r\n        return this.controller.getTime()\r\n    }\r\n    reset(){\r\n        this.controller.resetDanmaku(1)\r\n        this.controller.reset()\r\n        \r\n    }\r\n\r\n}\r\n//添加进全局\r\nif (globalThis) {\r\n    globalThis.MfunsDanMaku = MfunsDanMaku;\r\n}"],"sourceRoot":""}